

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>fluxfootprints package &mdash; fluxfootprint 0.1.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=92734c54"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="fluxfootprints" href="modules.html" />
    <link rel="prev" title="fluxfootprint documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            fluxfootprint
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">fluxfootprints package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-fluxfootprints.compare">fluxfootprints.compare module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#footprint-compare-py">footprint_compare.py</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dependencies">Dependencies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.compare.compare_footprints"><code class="docutils literal notranslate"><span class="pre">compare_footprints()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.compare.footprint_metrics"><code class="docutils literal notranslate"><span class="pre">footprint_metrics()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.compare.run_all_and_compare"><code class="docutils literal notranslate"><span class="pre">run_all_and_compare()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.compare.run_ffp"><code class="docutils literal notranslate"><span class="pre">run_ffp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.compare.run_ffp_xr"><code class="docutils literal notranslate"><span class="pre">run_ffp_xr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.compare.run_km"><code class="docutils literal notranslate"><span class="pre">run_km()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fluxfootprints.ep_footprint">fluxfootprints.ep_footprint module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.ep_footprint.Footprint"><code class="docutils literal notranslate"><span class="pre">Footprint</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.ep_footprint.Footprint.error"><code class="docutils literal notranslate"><span class="pre">Footprint.error()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.ep_footprint.Footprint.offset"><code class="docutils literal notranslate"><span class="pre">Footprint.offset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.ep_footprint.Footprint.peak"><code class="docutils literal notranslate"><span class="pre">Footprint.peak</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.ep_footprint.Footprint.x10"><code class="docutils literal notranslate"><span class="pre">Footprint.x10</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.ep_footprint.Footprint.x30"><code class="docutils literal notranslate"><span class="pre">Footprint.x30</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.ep_footprint.Footprint.x50"><code class="docutils literal notranslate"><span class="pre">Footprint.x50</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.ep_footprint.Footprint.x70"><code class="docutils literal notranslate"><span class="pre">Footprint.x70</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.ep_footprint.Footprint.x80"><code class="docutils literal notranslate"><span class="pre">Footprint.x80</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.ep_footprint.Footprint.x90"><code class="docutils literal notranslate"><span class="pre">Footprint.x90</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.ep_footprint.handle_footprint"><code class="docutils literal notranslate"><span class="pre">handle_footprint()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.ep_footprint.hsieh"><code class="docutils literal notranslate"><span class="pre">hsieh()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.ep_footprint.kljun"><code class="docutils literal notranslate"><span class="pre">kljun()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.ep_footprint.kormann_meixner"><code class="docutils literal notranslate"><span class="pre">kormann_meixner()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fluxfootprints.ffp_xr">fluxfootprints.ffp_xr module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.ffp_xr.ffp_climatology_new"><code class="docutils literal notranslate"><span class="pre">ffp_climatology_new</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.ffp_xr.ffp_climatology_new.calc_xr_footprint"><code class="docutils literal notranslate"><span class="pre">ffp_climatology_new.calc_xr_footprint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.ffp_xr.ffp_climatology_new.create_xr_dataset"><code class="docutils literal notranslate"><span class="pre">ffp_climatology_new.create_xr_dataset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.ffp_xr.ffp_climatology_new.define_domain"><code class="docutils literal notranslate"><span class="pre">ffp_climatology_new.define_domain()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.ffp_xr.ffp_climatology_new.prep_df_fields"><code class="docutils literal notranslate"><span class="pre">ffp_climatology_new.prep_df_fields()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.ffp_xr.ffp_climatology_new.raise_ffp_exception"><code class="docutils literal notranslate"><span class="pre">ffp_climatology_new.raise_ffp_exception()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.ffp_xr.ffp_climatology_new.run"><code class="docutils literal notranslate"><span class="pre">ffp_climatology_new.run()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.ffp_xr.ffp_climatology_new.smooth_and_contour"><code class="docutils literal notranslate"><span class="pre">ffp_climatology_new.smooth_and_contour()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fluxfootprints.footprint_plotting">fluxfootprints.footprint_plotting module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.footprint_plotting.FootprintPlotter"><code class="docutils literal notranslate"><span class="pre">FootprintPlotter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.footprint_plotting.FootprintPlotter.get_contour_levels"><code class="docutils literal notranslate"><span class="pre">FootprintPlotter.get_contour_levels()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.footprint_plotting.FootprintPlotter.get_contour_vertices"><code class="docutils literal notranslate"><span class="pre">FootprintPlotter.get_contour_vertices()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.footprint_plotting.FootprintPlotter.plot_footprint"><code class="docutils literal notranslate"><span class="pre">FootprintPlotter.plot_footprint()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.footprint_plotting.add_plotting_to_footprint"><code class="docutils literal notranslate"><span class="pre">add_plotting_to_footprint()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fluxfootprints.improved_ffp">fluxfootprints.improved_ffp module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel"><code class="docutils literal notranslate"><span class="pre">FFPModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.REQUIRED_COLUMNS"><code class="docutils literal notranslate"><span class="pre">FFPModel.REQUIRED_COLUMNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.apply_paper_smoothing"><code class="docutils literal notranslate"><span class="pre">FFPModel.apply_paper_smoothing()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.apply_rsl_corrections"><code class="docutils literal notranslate"><span class="pre">FFPModel.apply_rsl_corrections()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_2d_footprint"><code class="docutils literal notranslate"><span class="pre">FFPModel.calc_2d_footprint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_crosswind_dispersion"><code class="docutils literal notranslate"><span class="pre">FFPModel.calc_crosswind_dispersion()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_crosswind_extent"><code class="docutils literal notranslate"><span class="pre">FFPModel.calc_crosswind_extent()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_crosswind_integrated_extent"><code class="docutils literal notranslate"><span class="pre">FFPModel.calc_crosswind_integrated_extent()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_crosswind_integrated_footprint"><code class="docutils literal notranslate"><span class="pre">FFPModel.calc_crosswind_integrated_footprint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_crosswind_spread"><code class="docutils literal notranslate"><span class="pre">FFPModel.calc_crosswind_spread()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_crosswind_spread_xr"><code class="docutils literal notranslate"><span class="pre">FFPModel.calc_crosswind_spread_xr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_peak_based_limits"><code class="docutils literal notranslate"><span class="pre">FFPModel.calc_peak_based_limits()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_pi_4"><code class="docutils literal notranslate"><span class="pre">FFPModel.calc_pi_4()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_real_footprint_peak"><code class="docutils literal notranslate"><span class="pre">FFPModel.calc_real_footprint_peak()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_scaled_distance_rsl"><code class="docutils literal notranslate"><span class="pre">FFPModel.calc_scaled_distance_rsl()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_scaled_footprint_peak"><code class="docutils literal notranslate"><span class="pre">FFPModel.calc_scaled_footprint_peak()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_scaled_x"><code class="docutils literal notranslate"><span class="pre">FFPModel.calc_scaled_x()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_unstable_psi"><code class="docutils literal notranslate"><span class="pre">FFPModel.calc_unstable_psi()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_xr_footprint"><code class="docutils literal notranslate"><span class="pre">FFPModel.calc_xr_footprint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calculate_pi_groups"><code class="docutils literal notranslate"><span class="pre">FFPModel.calculate_pi_groups()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calculate_source_areas"><code class="docutils literal notranslate"><span class="pre">FFPModel.calculate_source_areas()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.check_rsl_validity"><code class="docutils literal notranslate"><span class="pre">FFPModel.check_rsl_validity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.check_validity_ranges"><code class="docutils literal notranslate"><span class="pre">FFPModel.check_validity_ranges()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.create_xr_dataset"><code class="docutils literal notranslate"><span class="pre">FFPModel.create_xr_dataset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.define_domain"><code class="docutils literal notranslate"><span class="pre">FFPModel.define_domain()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.get_scalar_value"><code class="docutils literal notranslate"><span class="pre">FFPModel.get_scalar_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.get_source_area_contour"><code class="docutils literal notranslate"><span class="pre">FFPModel.get_source_area_contour()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.handle_stability_regimes"><code class="docutils literal notranslate"><span class="pre">FFPModel.handle_stability_regimes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.initialize_model_parameters"><code class="docutils literal notranslate"><span class="pre">FFPModel.initialize_model_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.plot_footprint"><code class="docutils literal notranslate"><span class="pre">FFPModel.plot_footprint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.prep_df_fields"><code class="docutils literal notranslate"><span class="pre">FFPModel.prep_df_fields()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.run"><code class="docutils literal notranslate"><span class="pre">FFPModel.run()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.save_results"><code class="docutils literal notranslate"><span class="pre">FFPModel.save_results()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.scale_crosswind_dispersion"><code class="docutils literal notranslate"><span class="pre">FFPModel.scale_crosswind_dispersion()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.scale_to_real_distance"><code class="docutils literal notranslate"><span class="pre">FFPModel.scale_to_real_distance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.verify_data"><code class="docutils literal notranslate"><span class="pre">FFPModel.verify_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.verify_results"><code class="docutils literal notranslate"><span class="pre">FFPModel.verify_results()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fluxfootprints.tools">fluxfootprints.tools module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.tools.aggregate_to_daily_centroid"><code class="docutils literal notranslate"><span class="pre">aggregate_to_daily_centroid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.tools.concat_fetch_gdf"><code class="docutils literal notranslate"><span class="pre">concat_fetch_gdf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.tools.generate_density_raster"><code class="docutils literal notranslate"><span class="pre">generate_density_raster()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.tools.impute_evapotranspiration"><code class="docutils literal notranslate"><span class="pre">impute_evapotranspiration()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.tools.polar_to_cartesian_dataframe"><code class="docutils literal notranslate"><span class="pre">polar_to_cartesian_dataframe()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fluxfootprints.volk">fluxfootprints.volk module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.volk.calc_hourly_ffp"><code class="docutils literal notranslate"><span class="pre">calc_hourly_ffp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.volk.calc_hourly_ffp_xr"><code class="docutils literal notranslate"><span class="pre">calc_hourly_ffp_xr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.volk.calc_nldas_refet"><code class="docutils literal notranslate"><span class="pre">calc_nldas_refet()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.volk.clip_to_utah_merge"><code class="docutils literal notranslate"><span class="pre">clip_to_utah_merge()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.volk.download_nldas"><code class="docutils literal notranslate"><span class="pre">download_nldas()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.volk.extract_nldas_xr_to_df"><code class="docutils literal notranslate"><span class="pre">extract_nldas_xr_to_df()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.volk.fetch_and_preprocess_data"><code class="docutils literal notranslate"><span class="pre">fetch_and_preprocess_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.volk.find_transform"><code class="docutils literal notranslate"><span class="pre">find_transform()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.volk.load_configs"><code class="docutils literal notranslate"><span class="pre">load_configs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.volk.mask_fp_cutoff"><code class="docutils literal notranslate"><span class="pre">mask_fp_cutoff()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.volk.multiply_directories_rast"><code class="docutils literal notranslate"><span class="pre">multiply_directories_rast()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.volk.multiply_geotiffs"><code class="docutils literal notranslate"><span class="pre">multiply_geotiffs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.volk.norm_dly_et"><code class="docutils literal notranslate"><span class="pre">norm_dly_et()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.volk.norm_minmax_dly_et"><code class="docutils literal notranslate"><span class="pre">norm_minmax_dly_et()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.volk.normalize_eto_df"><code class="docutils literal notranslate"><span class="pre">normalize_eto_df()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.volk.outline_valid_cells"><code class="docutils literal notranslate"><span class="pre">outline_valid_cells()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.volk.read_compiled_input"><code class="docutils literal notranslate"><span class="pre">read_compiled_input()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.volk.reproject_raster_dir"><code class="docutils literal notranslate"><span class="pre">reproject_raster_dir()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.volk.snap_centroid"><code class="docutils literal notranslate"><span class="pre">snap_centroid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.volk.weighted_rasters"><code class="docutils literal notranslate"><span class="pre">weighted_rasters()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluxfootprints.volk.write_footprint_to_raster"><code class="docutils literal notranslate"><span class="pre">write_footprint_to_raster()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-fluxfootprints">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">fluxfootprints</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">fluxfootprints package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-fluxfootprints.compare">fluxfootprints.compare module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#footprint-compare-py">footprint_compare.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.compare.compare_footprints"><code class="docutils literal notranslate"><span class="pre">compare_footprints()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.compare.footprint_metrics"><code class="docutils literal notranslate"><span class="pre">footprint_metrics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.compare.run_all_and_compare"><code class="docutils literal notranslate"><span class="pre">run_all_and_compare()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.compare.run_ffp"><code class="docutils literal notranslate"><span class="pre">run_ffp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.compare.run_ffp_xr"><code class="docutils literal notranslate"><span class="pre">run_ffp_xr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.compare.run_km"><code class="docutils literal notranslate"><span class="pre">run_km()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-fluxfootprints.ep_footprint">fluxfootprints.ep_footprint module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.ep_footprint.Footprint"><code class="docutils literal notranslate"><span class="pre">Footprint</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.ep_footprint.handle_footprint"><code class="docutils literal notranslate"><span class="pre">handle_footprint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.ep_footprint.hsieh"><code class="docutils literal notranslate"><span class="pre">hsieh()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.ep_footprint.kljun"><code class="docutils literal notranslate"><span class="pre">kljun()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.ep_footprint.kormann_meixner"><code class="docutils literal notranslate"><span class="pre">kormann_meixner()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-fluxfootprints.ffp_xr">fluxfootprints.ffp_xr module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.ffp_xr.ffp_climatology_new"><code class="docutils literal notranslate"><span class="pre">ffp_climatology_new</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-fluxfootprints.footprint_plotting">fluxfootprints.footprint_plotting module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.footprint_plotting.FootprintPlotter"><code class="docutils literal notranslate"><span class="pre">FootprintPlotter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.footprint_plotting.add_plotting_to_footprint"><code class="docutils literal notranslate"><span class="pre">add_plotting_to_footprint()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-fluxfootprints.improved_ffp">fluxfootprints.improved_ffp module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel"><code class="docutils literal notranslate"><span class="pre">FFPModel</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-fluxfootprints.tools">fluxfootprints.tools module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.tools.aggregate_to_daily_centroid"><code class="docutils literal notranslate"><span class="pre">aggregate_to_daily_centroid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.tools.concat_fetch_gdf"><code class="docutils literal notranslate"><span class="pre">concat_fetch_gdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.tools.generate_density_raster"><code class="docutils literal notranslate"><span class="pre">generate_density_raster()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.tools.impute_evapotranspiration"><code class="docutils literal notranslate"><span class="pre">impute_evapotranspiration()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.tools.polar_to_cartesian_dataframe"><code class="docutils literal notranslate"><span class="pre">polar_to_cartesian_dataframe()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-fluxfootprints.volk">fluxfootprints.volk module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.volk.calc_hourly_ffp"><code class="docutils literal notranslate"><span class="pre">calc_hourly_ffp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.volk.calc_hourly_ffp_xr"><code class="docutils literal notranslate"><span class="pre">calc_hourly_ffp_xr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.volk.calc_nldas_refet"><code class="docutils literal notranslate"><span class="pre">calc_nldas_refet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.volk.clip_to_utah_merge"><code class="docutils literal notranslate"><span class="pre">clip_to_utah_merge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.volk.download_nldas"><code class="docutils literal notranslate"><span class="pre">download_nldas()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.volk.extract_nldas_xr_to_df"><code class="docutils literal notranslate"><span class="pre">extract_nldas_xr_to_df()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.volk.fetch_and_preprocess_data"><code class="docutils literal notranslate"><span class="pre">fetch_and_preprocess_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.volk.find_transform"><code class="docutils literal notranslate"><span class="pre">find_transform()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.volk.load_configs"><code class="docutils literal notranslate"><span class="pre">load_configs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.volk.mask_fp_cutoff"><code class="docutils literal notranslate"><span class="pre">mask_fp_cutoff()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.volk.multiply_directories_rast"><code class="docutils literal notranslate"><span class="pre">multiply_directories_rast()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.volk.multiply_geotiffs"><code class="docutils literal notranslate"><span class="pre">multiply_geotiffs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.volk.norm_dly_et"><code class="docutils literal notranslate"><span class="pre">norm_dly_et()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.volk.norm_minmax_dly_et"><code class="docutils literal notranslate"><span class="pre">norm_minmax_dly_et()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.volk.normalize_eto_df"><code class="docutils literal notranslate"><span class="pre">normalize_eto_df()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.volk.outline_valid_cells"><code class="docutils literal notranslate"><span class="pre">outline_valid_cells()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.volk.read_compiled_input"><code class="docutils literal notranslate"><span class="pre">read_compiled_input()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.volk.reproject_raster_dir"><code class="docutils literal notranslate"><span class="pre">reproject_raster_dir()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.volk.snap_centroid"><code class="docutils literal notranslate"><span class="pre">snap_centroid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.volk.weighted_rasters"><code class="docutils literal notranslate"><span class="pre">weighted_rasters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluxfootprints.volk.write_footprint_to_raster"><code class="docutils literal notranslate"><span class="pre">write_footprint_to_raster()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-fluxfootprints">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="exp.html">Flux Footprints: Key Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="modeltypes.html">Outline of Flux Measurement Footprint Estimation Approaches</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/footprint.html">Quick-start notebook</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">fluxfootprint</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">fluxfootprints package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/fluxfootprints.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="fluxfootprints-package">
<h1>fluxfootprints package<a class="headerlink" href="#fluxfootprints-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-fluxfootprints.compare">
<span id="fluxfootprints-compare-module"></span><h2>fluxfootprints.compare module<a class="headerlink" href="#module-fluxfootprints.compare" title="Link to this heading"></a></h2>
<section id="footprint-compare-py">
<h3>footprint_compare.py<a class="headerlink" href="#footprint-compare-py" title="Link to this heading"></a></h3>
<p>Utility functions for computing and comparing eddy‑covariance flux‑footprint
models.</p>
<p>The module provides a small toolkit to <strong>re‑run the side‑by‑side evaluations</strong>
we discussed earlier:</p>
<ol class="arabic simple">
<li><p>Run multiple footprint models (classic Kljun‑FFP, the xarray rewrite
<code class="docutils literal notranslate"><span class="pre">ffp_xr</span></code>, the analytic Kormann‑Meixner (KM) approximation, or any other
user‑supplied function).</p></li>
<li><p>Compute common diagnostic metrics against a chosen reference model
(RMSE, peak‑location bias, 80 % source‑area overlap).</p></li>
<li><p>Return a tidy <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> <em>and</em> create optional difference plots.</p></li>
</ol>
<p>All heavy lifting (meteorological inputs, domain definition …) is delegated to
existing model APIs; this file is purely orchestration + diagnostics.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span><span class="o">,</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">footprint_compare</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">run_ffp</span><span class="p">,</span> <span class="n">run_ffp_xr</span><span class="p">,</span> <span class="n">run_km</span><span class="p">,</span> <span class="n">compare_footprints</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>  <span class="c1"># 24 h synthetic</span>
<span class="gp">... </span>    <span class="s2">&quot;wind_dir&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;ws&quot;</span><span class="p">:</span> <span class="mf">5.0</span><span class="p">,</span> <span class="s2">&quot;sigmav&quot;</span><span class="p">:</span> <span class="mf">.5</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;ustar&quot;</span><span class="p">:</span> <span class="mf">.3</span><span class="p">,</span> <span class="s2">&quot;ol&quot;</span><span class="p">:</span> <span class="mf">200.0</span><span class="p">},</span>
<span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2025-05-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dom</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="o">-</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_ref</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">run_ffp</span><span class="p">(</span><span class="n">met</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">dom</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_xr</span><span class="p">,</span>  <span class="n">_</span>       <span class="o">=</span> <span class="n">run_ffp_xr</span><span class="p">(</span><span class="n">met</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">dom</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">compare_footprints</span><span class="p">(</span><span class="n">f_ref</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="p">{</span><span class="s2">&quot;FFP_xr&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">f_xr</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
<section id="dependencies">
<h4>Dependencies<a class="headerlink" href="#dependencies" title="Link to this heading"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">numpy,</span> <span class="pre">pandas,</span> <span class="pre">matplotlib,</span> <span class="pre">scipy</span></code>;
footprint models: <code class="docutils literal notranslate"><span class="pre">calc_footprint_FFP_climatology</span></code>, <code class="docutils literal notranslate"><span class="pre">ffp_xr</span></code> (these must be
importable, e.g. placed on <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code>).</p>
</section>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.compare.compare_footprints">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.compare.</span></span><span class="sig-name descname"><span class="pre">compare_footprints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">others</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RdBu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/fluxfootprints/compare.html#compare_footprints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.compare.compare_footprints" title="Link to this definition"></a></dt>
<dd><p>Compute metrics for <em>others</em> against reference; optionally plot diffs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ref_f / ref_grid</strong></dt><dd><p>Reference footprint density and its (x_2d, y_2d) grids.</p>
</dd>
<dt><strong>others</strong></dt><dd><p>Dict mapping <em>name</em> → (f_2d, (x_2d, y_2d)).</p>
</dd>
<dt><strong>plot</strong></dt><dd><p>If True, draw a difference map for each entry.</p>
</dd>
<dt><strong>vlim</strong></dt><dd><p>Symmetric colour‑bar limit for difference plots.  By default the max
absolute difference across all models is used.</p>
</dd>
<dt><strong>Returns</strong></dt><dd></dd>
<dt><strong>——-</strong></dt><dd></dd>
<dt><strong>``pandas.DataFrame`` with rows = model names, columns = metrics.</strong></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.compare.footprint_metrics">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.compare.</span></span><span class="sig-name descname"><span class="pre">footprint_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_ref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_ref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_ref</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/fluxfootprints/compare.html#footprint_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.compare.footprint_metrics" title="Link to this definition"></a></dt>
<dd><p>Compute diagnostic comparison metrics between two footprint distributions.</p>
<p>Compares a test footprint (<cite>f_other</cite>) against a reference footprint (<cite>f_ref</cite>)
using several spatial metrics: root mean squared error (RMSE), peak location difference,
and percentage overlap of the 80% contribution area.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>f_ref</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Reference footprint values on a 2D grid.</p>
</dd>
<dt><strong>x_ref</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>X-coordinates for the reference footprint grid.</p>
</dd>
<dt><strong>y_ref</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Y-coordinates for the reference footprint grid.</p>
</dd>
<dt><strong>f_other</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Footprint values from the model being compared.</p>
</dd>
<dt><strong>x_other</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>X-coordinates for the comparison footprint grid.</p>
</dd>
<dt><strong>y_other</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Y-coordinates for the comparison footprint grid.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>metrics</strong><span class="classifier">dict of str to float</span></dt><dd><p>Dictionary containing:
- ‘RMSE’ : Root mean squared error between footprints.
- ‘Peak_ref’ : Distance of the peak location in the reference footprint from the origin [m].
- ‘Peak_other’ : Distance of the peak location in the comparison footprint from the origin [m].
- ‘Peak_diff’ : Absolute difference in peak distances [m].
- ‘Overlap80(%)’ : Percent overlap of 80% contribution regions [%].</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If the input grids are not congruent in shape.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.compare.run_all_and_compare">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.compare.</span></span><span class="sig-name descname"><span class="pre">run_all_and_compare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">met</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(-300,</span> <span class="pre">300,</span> <span class="pre">-300,</span> <span class="pre">300)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_km</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_xr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_volk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">extra_kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/fluxfootprints/compare.html#run_all_and_compare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.compare.run_all_and_compare" title="Link to this definition"></a></dt>
<dd><p>Run multiple footprint models and compare their outputs to a reference.</p>
<p>Executes several footprint models (FFP, FFP_xr, and optionally KM and Volk)
using a common meteorological dataset and spatial domain. Each model’s output
is compared to the FFP reference using RMSE, peak distance, and 80% overlap metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>met</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>DataFrame containing meteorological inputs, expected to include:
- ‘ol’ : Obukhov length [m]
- ‘sigmav’ : Lateral standard deviation of velocity [m/s]
- ‘ustar’ : Friction velocity [m/s]
- ‘wind_dir’ : Wind direction [degrees]</p>
</dd>
<dt><strong>domain</strong><span class="classifier">tuple of float, optional</span></dt><dd><p>Spatial extent of the footprint domain (xmin, xmax, ymin, ymax). Default is (-300, 300, -300, 300).</p>
</dd>
<dt><strong>dx</strong><span class="classifier">float, optional</span></dt><dd><p>Grid resolution in meters. Default is 2.0.</p>
</dd>
<dt><strong>zm</strong><span class="classifier">float, optional</span></dt><dd><p>Measurement height [m]. Default is 2.0.</p>
</dd>
<dt><strong>z0</strong><span class="classifier">float, optional</span></dt><dd><p>Surface roughness length [m]. Default is 0.1.</p>
</dd>
<dt><strong>h</strong><span class="classifier">float, optional</span></dt><dd><p>Boundary layer height [m]. Default is 2000.0.</p>
</dd>
<dt><strong>include_km</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to include the KM toy model in the comparison. Default is True.</p>
</dd>
<dt><strong>include_xr</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to include the <cite>ffp_xr</cite> model in the comparison. Default is True.</p>
</dd>
<dt><strong>include_volk</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to include a Volk-style model (placeholder). Default is False.</p>
</dd>
<dt><strong>**extra_kwargs</strong></dt><dd><p>Additional arguments passed to <cite>run_ffp</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>df_metrics</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>DataFrame of comparison metrics (RMSE, peak location, 80% overlap)
for each alternative model relative to the FFP reference.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The “Volk” model is not implemented and is only a placeholder.</p></li>
<li><p>The function generates a comparison plot using <cite>compare_footprints(plot=True)</cite>.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.compare.run_ffp">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.compare.</span></span><span class="sig-name descname"><span class="pre">run_ffp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">met</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">zm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(-300,</span> <span class="pre">300,</span> <span class="pre">-300,</span> <span class="pre">300)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">extra_kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/fluxfootprints/compare.html#run_ffp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.compare.run_ffp" title="Link to this definition"></a></dt>
<dd><p>Compute the footprint climatology using the classic FFP implementation.</p>
<p>This function runs the <cite>FFP_climatology</cite> model from the
<cite>calc_footprint_FFP_climatology</cite> module, generating a 2D footprint
and corresponding spatial grid arrays based on provided meteorological inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>met</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>DataFrame containing time series of meteorological variables.
Expected columns include:
- ‘ol’ : Obukhov length [m]
- ‘sigmav’ : Standard deviation of lateral velocity [m/s]
- ‘ustar’ : Friction velocity [m/s]
- ‘wind_dir’ : Wind direction [degrees]</p>
</dd>
<dt><strong>zm</strong><span class="classifier">float, optional</span></dt><dd><p>Measurement height above displacement height [m]. Default is 2.0.</p>
</dd>
<dt><strong>z0</strong><span class="classifier">float, optional</span></dt><dd><p>Surface roughness length [m]. Default is 0.1.</p>
</dd>
<dt><strong>h</strong><span class="classifier">float, optional</span></dt><dd><p>Boundary layer height [m]. Default is 2000.0.</p>
</dd>
<dt><strong>domain</strong><span class="classifier">list of float or tuple of float, optional</span></dt><dd><p>Spatial extent of the footprint domain in the format
(xmin, xmax, ymin, ymax). Default is (-300, 300, -300, 300).</p>
</dd>
<dt><strong>dx</strong><span class="classifier">float, optional</span></dt><dd><p>Grid resolution in both x and y directions [m]. Default is 2.0.</p>
</dd>
<dt><strong>**extra_kwargs</strong></dt><dd><p>Additional keyword arguments passed to <cite>FFP_climatology</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ffp_2d</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>2D array of footprint climatology values.</p>
</dd>
<dt><strong>(x, y)</strong><span class="classifier">tuple of numpy.ndarray</span></dt><dd><p>Tuple of 2D coordinate arrays for the x and y spatial grid [m].</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.compare.run_ffp_xr">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.compare.</span></span><span class="sig-name descname"><span class="pre">run_ffp_xr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">met</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(-300,</span> <span class="pre">300,</span> <span class="pre">-300,</span> <span class="pre">300)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">extra_kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/fluxfootprints/compare.html#run_ffp_xr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.compare.run_ffp_xr" title="Link to this definition"></a></dt>
<dd><p>Compute the footprint climatology using the xarray-based FFP implementation.</p>
<p>This function runs the <cite>ffp_climatology_new</cite> model from the <cite>ffp_xr</cite> module
on a meteorological input DataFrame, returning the 2D footprint
and associated spatial grid coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>met</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>DataFrame containing meteorological inputs for footprint modeling.</p>
</dd>
<dt><strong>domain</strong><span class="classifier">list of float or tuple of float, optional</span></dt><dd><p>Spatial extent of the footprint domain in the format
(xmin, xmax, ymin, ymax). Default is (-300, 300, -300, 300).</p>
</dd>
<dt><strong>dx</strong><span class="classifier">float, optional</span></dt><dd><p>Grid resolution in both x and y directions. Default is 2.0.</p>
</dd>
<dt><strong>logger</strong><span class="classifier">logging.Logger or None, optional</span></dt><dd><p>Logger instance for model output. If None, a default logger is created.</p>
</dd>
<dt><strong>**extra_kwargs</strong></dt><dd><p>Additional keyword arguments passed to <cite>ffp_climatology_new</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ffp_2d</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>2D array representing the climatological footprint values.</p>
</dd>
<dt><strong>(x, y)</strong><span class="classifier">tuple of numpy.ndarray</span></dt><dd><p>Tuple of arrays representing the x and y coordinates of the footprint grid.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.compare.run_km">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.compare.</span></span><span class="sig-name descname"><span class="pre">run_km</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">met</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">zm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(-300,</span> <span class="pre">300,</span> <span class="pre">-300,</span> <span class="pre">300)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">extra_kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/fluxfootprints/compare.html#run_km"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.compare.run_km" title="Link to this definition"></a></dt>
<dd><p>Compute a toy 2D footprint based on a Kormann–Meixner-style analytic solution.</p>
<p>This simplified implementation models the footprint as a product of a
1D Gamma distribution in the along-wind (y) direction and a Gaussian in the
cross-wind (x) direction. It is intended as a minimal, conceptual reference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>met</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Meteorological input data (unused in this implementation, but included for API compatibility).</p>
</dd>
<dt><strong>zm</strong><span class="classifier">float, optional</span></dt><dd><p>Measurement height above displacement height [m]. Default is 2.0.</p>
</dd>
<dt><strong>z0</strong><span class="classifier">float, optional</span></dt><dd><p>Surface roughness length [m]. Default is 0.1.</p>
</dd>
<dt><strong>domain</strong><span class="classifier">list of float or tuple of float, optional</span></dt><dd><p>Spatial extent of the footprint domain in the format
(xmin, xmax, ymin, ymax). Default is (-300, 300, -300, 300).</p>
</dd>
<dt><strong>dx</strong><span class="classifier">float, optional</span></dt><dd><p>Grid resolution in both x and y directions [m]. Default is 2.0.</p>
</dd>
<dt><strong>**extra_kwargs</strong></dt><dd><p>Ignored in this implementation. Included for API consistency.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>f2d</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>2D array of normalized footprint values.</p>
</dd>
<dt><strong>(xv, yv)</strong><span class="classifier">tuple of numpy.ndarray</span></dt><dd><p>Tuple of 2D arrays representing the x and y coordinates of the grid [m].</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The analytic form is loosely inspired by Kormann &amp; Meixner (2001) under neutral conditions.</p></li>
<li><p>Not intended for production use; serves as a placeholder or toy model.</p></li>
</ul>
</dd></dl>

</section>
<section id="module-fluxfootprints.ep_footprint">
<span id="fluxfootprints-ep-footprint-module"></span><h2>fluxfootprints.ep_footprint module<a class="headerlink" href="#module-fluxfootprints.ep_footprint" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="fluxfootprints.ep_footprint.Footprint">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fluxfootprints.ep_footprint.</span></span><span class="sig-name descname"><span class="pre">Footprint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">peak</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x10</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x30</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x50</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x70</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x80</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x90</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/ep_footprint.html#Footprint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.ep_footprint.Footprint" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to store footprint calculation results</p>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#fluxfootprints.ep_footprint.Footprint.error" title="fluxfootprints.ep_footprint.Footprint.error"><code class="xref py py-obj docutils literal notranslate"><span class="pre">error</span></code></a>()</p></td>
<td><p>Create an error footprint with all values set to -9999</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.ep_footprint.Footprint.error">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">error</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/ep_footprint.html#Footprint.error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.ep_footprint.Footprint.error" title="Link to this definition"></a></dt>
<dd><p>Create an error footprint with all values set to -9999</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fluxfootprints.ep_footprint.Footprint.offset">
<span class="sig-name descname"><span class="pre">offset</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#fluxfootprints.ep_footprint.Footprint.offset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fluxfootprints.ep_footprint.Footprint.peak">
<span class="sig-name descname"><span class="pre">peak</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#fluxfootprints.ep_footprint.Footprint.peak" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fluxfootprints.ep_footprint.Footprint.x10">
<span class="sig-name descname"><span class="pre">x10</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#fluxfootprints.ep_footprint.Footprint.x10" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fluxfootprints.ep_footprint.Footprint.x30">
<span class="sig-name descname"><span class="pre">x30</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#fluxfootprints.ep_footprint.Footprint.x30" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fluxfootprints.ep_footprint.Footprint.x50">
<span class="sig-name descname"><span class="pre">x50</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#fluxfootprints.ep_footprint.Footprint.x50" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fluxfootprints.ep_footprint.Footprint.x70">
<span class="sig-name descname"><span class="pre">x70</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#fluxfootprints.ep_footprint.Footprint.x70" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fluxfootprints.ep_footprint.Footprint.x80">
<span class="sig-name descname"><span class="pre">x80</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#fluxfootprints.ep_footprint.Footprint.x80" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fluxfootprints.ep_footprint.Footprint.x90">
<span class="sig-name descname"><span class="pre">x90</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#fluxfootprints.ep_footprint.Footprint.x90" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.ep_footprint.handle_footprint">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.ep_footprint.</span></span><span class="sig-name descname"><span class="pre">handle_footprint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var_w</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ustar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zL</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind_speed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MO_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sonic_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rough_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">foot_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'kljun_04'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fluxfootprints.ep_footprint.Footprint" title="fluxfootprints.ep_footprint.Footprint"><span class="pre">Footprint</span></a></span></span><a class="reference internal" href="_modules/fluxfootprints/ep_footprint.html#handle_footprint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.ep_footprint.handle_footprint" title="Link to this definition"></a></dt>
<dd><p>Dispatch function for selecting and computing flux footprint models.</p>
<p>This function selects an appropriate footprint model based on user input
and input parameter validity. It supports three footprint models: Kljun et al. (2004),
Kormann and Meixner (2001), and Hsieh et al. (2000). Automatically switches to a
fallback model if input constraints are violated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>var_w</strong><span class="classifier">float</span></dt><dd><p>Variance of vertical wind speed [m² s⁻²].</p>
</dd>
<dt><strong>ustar</strong><span class="classifier">float</span></dt><dd><p>Friction velocity [m s⁻¹].</p>
</dd>
<dt><strong>zL</strong><span class="classifier">float</span></dt><dd><p>Stability parameter (z / L) [-].</p>
</dd>
<dt><strong>wind_speed</strong><span class="classifier">float</span></dt><dd><p>Mean horizontal wind speed [m s⁻¹].</p>
</dd>
<dt><strong>MO_length</strong><span class="classifier">float</span></dt><dd><p>Monin-Obukhov length [m].</p>
</dd>
<dt><strong>sonic_height</strong><span class="classifier">float</span></dt><dd><p>Height of the sonic anemometer above ground level [m].</p>
</dd>
<dt><strong>disp_height</strong><span class="classifier">float</span></dt><dd><p>Displacement height [m].</p>
</dd>
<dt><strong>rough_length</strong><span class="classifier">float</span></dt><dd><p>Surface roughness length [m].</p>
</dd>
<dt><strong>foot_model</strong><span class="classifier">str, optional</span></dt><dd><p>Footprint model to use: one of {“kljun_04”, “kormann_meixner_01”, “hsieh_00”}.
Defaults to “kljun_04”.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Footprint</dt><dd><p>A dataclass containing footprint distance metrics. Returns an error footprint
if the selected model or parameters are invalid.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">kljun_04</span></code></dt><dd><p>Analytical footprint model by Kljun et al. (2004).</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">kormann_meixner_01</span></code></dt><dd><p>Footprint model by Kormann and Meixner (2001).</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">hsieh_00</span></code></dt><dd><p>Footprint model by Hsieh et al. (2000).</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>If the <cite>“kljun_04”</cite> model is selected but input values are outside its
valid range, the function automatically switches to <cite>“kormann_meixner_01”</cite>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.ep_footprint.hsieh">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.ep_footprint.</span></span><span class="sig-name descname"><span class="pre">hsieh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MO_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sonic_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rough_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fluxfootprints.ep_footprint.Footprint" title="fluxfootprints.ep_footprint.Footprint"><span class="pre">Footprint</span></a></span></span><a class="reference internal" href="_modules/fluxfootprints/ep_footprint.html#hsieh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.ep_footprint.hsieh" title="Link to this definition"></a></dt>
<dd><p>Estimate footprint characteristics using the Hsieh et al. (2000) model.</p>
<p>This function implements the analytical footprint model developed by
Hsieh et al. (2000), based on Monin-Obukhov similarity theory and a
stability-dependent formulation. It calculates the peak flux contribution
distance and footprint extents based on integrated contributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>MO_length</strong><span class="classifier">float</span></dt><dd><p>Monin-Obukhov length [m].</p>
</dd>
<dt><strong>sonic_height</strong><span class="classifier">float</span></dt><dd><p>Height of the sonic anemometer above ground level [m].</p>
</dd>
<dt><strong>disp_height</strong><span class="classifier">float</span></dt><dd><p>Displacement height [m].</p>
</dd>
<dt><strong>rough_length</strong><span class="classifier">float</span></dt><dd><p>Surface roughness length [m].</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Footprint</dt><dd><p>A dataclass containing the peak location and distances at which 1%, 10%, 30%, 50%,
70%, 80%, and 90% of the footprint is accumulated.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The model distinguishes between stable, unstable, and neutral atmospheric conditions
using the stability parameter zL = zu / L.</p></li>
<li><p><cite>zu</cite> is a derived scaling height incorporating roughness and log-profile assumptions.</p></li>
<li><p>Integration is performed over 1D footprint function values to estimate distance thresholds.</p></li>
</ul>
<p class="rubric">References</p>
<p>Hsieh, C.-I., Katul, G., &amp; Chi, T.-W. (2000).
An analytical model for estimating the footprint of turbulent fluxes in
thermally stratified atmospheric flows.
Journal of Geophysical Research: Atmospheres, 105(D8), 9651–9664.
<a class="reference external" href="https://doi.org/10.1029/2000JD900052">https://doi.org/10.1029/2000JD900052</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.ep_footprint.kljun">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.ep_footprint.</span></span><span class="sig-name descname"><span class="pre">kljun</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">std_w</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ustar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zL</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sonic_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rough_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fluxfootprints.ep_footprint.Footprint" title="fluxfootprints.ep_footprint.Footprint"><span class="pre">Footprint</span></a></span></span><a class="reference internal" href="_modules/fluxfootprints/ep_footprint.html#kljun"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.ep_footprint.kljun" title="Link to this definition"></a></dt>
<dd><p>Estimate footprint characteristics using the Kljun et al. (2004) parameterization.</p>
<p>This function computes footprint distances corresponding to peak and cumulative
source area contributions (1–90%) using the analytical model from Kljun et al. (2004,
Boundary-Layer Meteorology). It assumes steady-state, horizontally homogeneous
turbulence and neutral to moderately stable or unstable atmospheric conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>std_w</strong><span class="classifier">float</span></dt><dd><p>Standard deviation of vertical velocity fluctuations [m s⁻¹].</p>
</dd>
<dt><strong>ustar</strong><span class="classifier">float</span></dt><dd><p>Friction velocity [m s⁻¹].</p>
</dd>
<dt><strong>zL</strong><span class="classifier">float</span></dt><dd><p>Stability parameter (z / L), where L is the Obukhov length [-].</p>
</dd>
<dt><strong>sonic_height</strong><span class="classifier">float</span></dt><dd><p>Height of the sonic anemometer above ground level [m].</p>
</dd>
<dt><strong>disp_height</strong><span class="classifier">float</span></dt><dd><p>Displacement height (zero-plane displacement) [m].</p>
</dd>
<dt><strong>rough_length</strong><span class="classifier">float</span></dt><dd><p>Surface roughness length [m].</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Footprint</dt><dd><p>A dataclass containing the peak location and distances at which 1%, 10%, 30%, 50%,
70%, 80%, and 90% of the footprint is accumulated. Returns an error footprint
if inputs are invalid.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The model is valid for:
- 0.01 &lt; z/L &lt; 15
- u* ≥ 0.21 m s⁻¹
- z - d &gt; 1.0 m
- z₀ &gt; 0</p>
<p class="rubric">References</p>
<p>Kljun, N., Calanca, P., Rotach, M. W., &amp; Schmid, H. P. (2004).
A simple parameterisation for flux footprint predictions.
Boundary-Layer Meteorology, 112(3), 503–523. <a class="reference external" href="https://doi.org/10.1023/B:BOUN.0000030653.71031.96">https://doi.org/10.1023/B:BOUN.0000030653.71031.96</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.ep_footprint.kormann_meixner">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.ep_footprint.</span></span><span class="sig-name descname"><span class="pre">kormann_meixner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ustar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zL</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind_speed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sonic_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#fluxfootprints.ep_footprint.Footprint" title="fluxfootprints.ep_footprint.Footprint"><span class="pre">Footprint</span></a></span></span><a class="reference internal" href="_modules/fluxfootprints/ep_footprint.html#kormann_meixner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.ep_footprint.kormann_meixner" title="Link to this definition"></a></dt>
<dd><p>Estimate footprint characteristics using the Kormann and Meixner (2001) analytical model.</p>
<p>This function computes the location of peak flux contribution and source area distances
corresponding to cumulative contributions of 1–90% using the model described by
Kormann and Meixner (2001). It integrates a 1D crosswind-integrated footprint function
derived from power-law profiles of wind speed and eddy diffusivity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ustar</strong><span class="classifier">float</span></dt><dd><p>Friction velocity [m s⁻¹].</p>
</dd>
<dt><strong>zL</strong><span class="classifier">float</span></dt><dd><p>Stability parameter (z / L) [-].</p>
</dd>
<dt><strong>wind_speed</strong><span class="classifier">float</span></dt><dd><p>Mean horizontal wind speed at measurement height [m s⁻¹].</p>
</dd>
<dt><strong>sonic_height</strong><span class="classifier">float</span></dt><dd><p>Height of the sonic anemometer above ground level [m].</p>
</dd>
<dt><strong>disp_height</strong><span class="classifier">float</span></dt><dd><p>Displacement height [m].</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Footprint</dt><dd><p>A dataclass containing the peak location and distances at which 1%, 10%, 30%, 50%,
70%, 80%, and 90% of the footprint is accumulated.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Applies Monin-Obukhov similarity theory for stability correction.</p></li>
<li><p>Assumes horizontally homogeneous surface conditions and power-law profiles for both
eddy diffusivity and wind speed.</p></li>
<li><p>Integration is terminated at 90% cumulative contribution.</p></li>
<li><p>For unstable conditions (z/L &lt; 0), non-linear stability corrections are applied via
Paulson (1970) similarity functions.</p></li>
</ul>
<p class="rubric">References</p>
<p>Kormann, R., &amp; Meixner, F. X. (2001).
An analytical footprint model for non-neutral stratification.
Boundary-Layer Meteorology, 99(2), 207–224. <a class="reference external" href="https://doi.org/10.1023/A:1018991015119">https://doi.org/10.1023/A:1018991015119</a></p>
</dd></dl>

</section>
<section id="module-fluxfootprints.ffp_xr">
<span id="fluxfootprints-ffp-xr-module"></span><h2>fluxfootprints.ffp_xr module<a class="headerlink" href="#module-fluxfootprints.ffp_xr" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="fluxfootprints.ffp_xr.ffp_climatology_new">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fluxfootprints.ffp_xr.</span></span><span class="sig-name descname"><span class="pre">ffp_climatology_new</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[-1000.0,</span> <span class="pre">1000.0,</span> <span class="pre">-1000.0,</span> <span class="pre">1000.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ny</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[0.1,</span> <span class="pre">0.2,</span> <span class="pre">0.3,</span> <span class="pre">0.4,</span> <span class="pre">0.5,</span> <span class="pre">0.6,</span> <span class="pre">0.7,</span> <span class="pre">0.8]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atm_bound_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inst_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rslayer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/ffp_xr.html#ffp_climatology_new"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.ffp_xr.ffp_climatology_new" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Create a footprint‑climatology from a series of individual flux‑footprint
estimates using the simple 2‑D parameterisation of Kljun et al. (2015).</p>
<p>The routine</p>
<ol class="arabic simple">
<li><p>computes a footprint for every time step,</p></li>
<li><p>rotates each footprint into its observed wind direction,</p></li>
<li><p>aggregates all footprints onto a common grid, and</p></li>
<li><p>derives user‑requested source‑area contours (<code class="docutils literal notranslate"><span class="pre">rs</span></code>).</p></li>
</ol>
<p>The implementation is based on:</p>
<blockquote>
<div><p>Kljun, N., Calanca, P., Rotach, M. W., &amp; Schmid, H. P. (2015).
<em>A simple two‑dimensional parameterisation for flux‑footprint
predictions (FFP)</em>. <strong>Geoscientific Model Development, 8</strong>, 3695‑3713.
<a class="reference external" href="https://doi.org/10.5194/gmd">https://doi.org/10.5194/gmd</a>‑8‑3695‑2015</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>zm</strong><span class="classifier">float or 1‑D array_like</span></dt><dd><p>Measurement height above displacement height (i.e.<code class="docutils literal notranslate"><span class="pre">z</span> <span class="pre">–</span> <span class="pre">d</span></code>) [m].</p>
</dd>
<dt><strong>z0</strong><span class="classifier">float or 1‑D array_like or None</span></dt><dd><p>Surface roughness length [m].  Either <cite>z0</cite> <strong>or</strong> <cite>umean</cite> must be
provided; if both are given, <cite>z0</cite> takes precedence.</p>
</dd>
<dt><strong>umean</strong><span class="classifier">float or 1‑D array_like or None</span></dt><dd><p>Mean wind speed at <cite>zm</cite> [m s⁻¹].</p>
</dd>
<dt><strong>h</strong><span class="classifier">1‑D array_like</span></dt><dd><p>Boundary‑layer height [m].</p>
</dd>
<dt><strong>ol</strong><span class="classifier">1‑D array_like</span></dt><dd><p>Obukhov length [m].</p>
</dd>
<dt><strong>sigmav</strong><span class="classifier">1‑D array_like</span></dt><dd><p>Standard deviation of lateral velocity fluctuations [m s⁻¹].</p>
</dd>
<dt><strong>ustar</strong><span class="classifier">1‑D array_like</span></dt><dd><p>Friction velocity [m s⁻¹].</p>
</dd>
<dt><strong>wind_dir</strong><span class="classifier">1‑D array_like</span></dt><dd><p>Wind direction in degrees (0–360°, meteorological convention).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#fluxfootprints.ffp_xr.ffp_climatology_new.smooth_and_contour" title="fluxfootprints.ffp_xr.ffp_climatology_new.smooth_and_contour"><code class="xref py py-obj docutils literal notranslate"><span class="pre">smooth_and_contour</span></code></a>([rs])</p></td>
<td><p>Compute footprint climatology using xarray structures for efficient, vectorized operations.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>calc_xr_footprint</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>create_xr_dataset</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>define_domain</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>prep_df_fields</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>raise_ffp_exception</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>run</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>FFP</strong><span class="classifier">dict</span></dt><dd><p>Dictionary with keys (see below) carrying the climatology results.</p>
</dd>
<dt><strong>x_2d, y_2d</strong><span class="classifier">ndarray</span></dt><dd><p>2‑D grids (mesh‑grids) of x and y coordinates [m].</p>
</dd>
<dt><strong>fclim_2d</strong><span class="classifier">ndarray</span></dt><dd><p>Normalised footprint‑climatology values [m⁻²].</p>
</dd>
<dt><strong>rs</strong><span class="classifier">ndarray or None</span></dt><dd><p>Echo of input <cite>rs</cite> in percent, or <em>None</em> when <cite>rs</cite> was <em>None</em>.</p>
</dd>
<dt><strong>fr</strong><span class="classifier">ndarray or None</span></dt><dd><p>Footprint value at each <cite>rs</cite> contour.</p>
</dd>
<dt><strong>xr, yr</strong><span class="classifier">list[ndarray] or None</span></dt><dd><p>x‑ and y‑coordinates of every <cite>rs</cite> contour line.</p>
</dd>
<dt><strong>n</strong><span class="classifier">int</span></dt><dd><p>Number of individual footprints used in the aggregation.</p>
</dd>
<dt><strong>flag_err</strong><span class="classifier">{0, 1, 2, 3}</span></dt><dd><p>Error/status flag:
<em>0</em> no error, <em>1</em> fatal error, <em>2</em> some contours outside domain,
<em>3</em> invalid input rows removed.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Other Parameters<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>domain</strong><span class="classifier">array_like of float, optional</span></dt><dd><p>Domain limits <code class="docutils literal notranslate"><span class="pre">[xmin,</span> <span class="pre">xmax,</span> <span class="pre">ymin,</span> <span class="pre">ymax]</span></code> [m].
Default is the smaller of</p>
<ul class="simple">
<li><p>the minimal rectangle that contains the <em>r</em> % footprint, or</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[-1000,</span> <span class="pre">1000,</span> <span class="pre">-1000,</span> <span class="pre">1000]</span></code>.</p></li>
</ul>
</dd>
<dt><strong>dx, dy</strong><span class="classifier">float, optional</span></dt><dd><p>Grid‑cell size in x and y [m].  Defaults to 2 m.  If only <cite>dx</cite>
is given, <cite>dy = dx</cite>.</p>
</dd>
<dt><strong>nx, ny</strong><span class="classifier">int, optional</span></dt><dd><p>Number of grid cells in x and y.  Defaults to 1000×1000.  Ignored
when <cite>dx</cite>/<cite>dy</cite> <strong>and</strong> <cite>domain</cite> are supplied (cell size wins).</p>
</dd>
<dt><strong>rs</strong><span class="classifier">float or sequence of float, optional</span></dt><dd><p>Source‑area percentages for which contour lines are returned,
e.g.<code class="docutils literal notranslate"><span class="pre">80</span></code> or <code class="docutils literal notranslate"><span class="pre">[10,</span> <span class="pre">30,</span> <span class="pre">80]</span></code>.  Values may be expressed as
percentages (<code class="docutils literal notranslate"><span class="pre">80</span></code>) or fractions (<code class="docutils literal notranslate"><span class="pre">0.8</span></code>).  Must be 10–90 %.
Default is <code class="docutils literal notranslate"><span class="pre">np.arange(10,</span> <span class="pre">90,</span> <span class="pre">10)</span></code>.  Use <code class="docutils literal notranslate"><span class="pre">None</span></code> to skip
contour calculations.</p>
</dd>
<dt><strong>rslayer</strong><span class="classifier">{0, 1}, optional</span></dt><dd><p>If 1, allow calculations when <cite>zm</cite> lies in the roughness sub‑layer
(RS).  <strong>Warning:</strong> the model is formally <strong>invalid</strong> within the RS,
so results are only indicative.  Requires <cite>z0</cite>.  Default is 0.</p>
</dd>
<dt><strong>smooth_data</strong><span class="classifier">{0, 1}, optional</span></dt><dd><p>Apply a convolution filter to smooth the footprint climatology.
Default is 1 (smooth).</p>
</dd>
<dt><strong>crop</strong><span class="classifier">{0, 1}, optional</span></dt><dd><p>Crop the output grid to the extent of the largest requested
contour (<cite>rs</cite>) or, if <cite>rs</cite> is <em>None</em>, the 80 % contour.  Default 0.</p>
</dd>
<dt><strong>pulse</strong><span class="classifier">int, optional</span></dt><dd><p>Print progress every <em>pulse</em> footprints.  Default is no output.</p>
</dd>
<dt><strong>verbosity</strong><span class="classifier">{0, 1, 2}, optional</span></dt><dd><p>Verbosity level: 0 = silent, 1 = only fatal messages, 2 = chatty.
Default 2.</p>
</dd>
<dt><strong>fig</strong><span class="classifier">{0, 1}, optional</span></dt><dd><p>Plot an example footprint on screen when set to 1.  Default 0.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><em>Implemented by</em> N. Kljun &amp; G. Fratini, originally in MATLAB,
ported to Python 3.x (v 1.4, 11 Dec 2019).</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">fluxfootprints</span><span class="w"> </span><span class="kn">import</span> <span class="n">ffp_climatology_new</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clim</span> <span class="o">=</span> <span class="n">ffp_climatology_new</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">zm</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">z0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">h</span><span class="o">=</span><span class="n">h_series</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">ol</span><span class="o">=</span><span class="n">ol_series</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">sigmav</span><span class="o">=</span><span class="n">sigmav_series</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">ustar</span><span class="o">=</span><span class="n">ustar_series</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">wind_dir</span><span class="o">=</span><span class="n">wd_series</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clim</span><span class="p">[</span><span class="s2">&quot;fclim_2d&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1000, 1000)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.ffp_xr.ffp_climatology_new.calc_xr_footprint">
<span class="sig-name descname"><span class="pre">calc_xr_footprint</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/ffp_xr.html#ffp_climatology_new.calc_xr_footprint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.ffp_xr.ffp_climatology_new.calc_xr_footprint" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.ffp_xr.ffp_climatology_new.create_xr_dataset">
<span class="sig-name descname"><span class="pre">create_xr_dataset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/ffp_xr.html#ffp_climatology_new.create_xr_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.ffp_xr.ffp_climatology_new.create_xr_dataset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.ffp_xr.ffp_climatology_new.define_domain">
<span class="sig-name descname"><span class="pre">define_domain</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/ffp_xr.html#ffp_climatology_new.define_domain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.ffp_xr.ffp_climatology_new.define_domain" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.ffp_xr.ffp_climatology_new.prep_df_fields">
<span class="sig-name descname"><span class="pre">prep_df_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zm_s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/ffp_xr.html#ffp_climatology_new.prep_df_fields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.ffp_xr.ffp_climatology_new.prep_df_fields" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.ffp_xr.ffp_climatology_new.raise_ffp_exception">
<span class="sig-name descname"><span class="pre">raise_ffp_exception</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/ffp_xr.html#ffp_climatology_new.raise_ffp_exception"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.ffp_xr.ffp_climatology_new.raise_ffp_exception" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.ffp_xr.ffp_climatology_new.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/ffp_xr.html#ffp_climatology_new.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.ffp_xr.ffp_climatology_new.run" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.ffp_xr.ffp_climatology_new.smooth_and_contour">
<span class="sig-name descname"><span class="pre">smooth_and_contour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.1,</span> <span class="pre">0.2,</span> <span class="pre">0.3,</span> <span class="pre">0.4,</span> <span class="pre">0.5,</span> <span class="pre">0.6,</span> <span class="pre">0.7,</span> <span class="pre">0.8]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/ffp_xr.html#ffp_climatology_new.smooth_and_contour"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.ffp_xr.ffp_climatology_new.smooth_and_contour" title="Link to this definition"></a></dt>
<dd><p>Compute footprint climatology using xarray structures for efficient, vectorized operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rs</strong> (<em>list</em>) – Contour levels to compute.</p></li>
<li><p><strong>smooth_data</strong> (<em>bool</em>) – Whether to smooth data using Gaussian filtering.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Aggregated footprint climatology.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-fluxfootprints.footprint_plotting">
<span id="fluxfootprints-footprint-plotting-module"></span><h2>fluxfootprints.footprint_plotting module<a class="headerlink" href="#module-fluxfootprints.footprint_plotting" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="fluxfootprints.footprint_plotting.FootprintPlotter">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fluxfootprints.footprint_plotting.</span></span><span class="sig-name descname"><span class="pre">FootprintPlotter</span></span><a class="reference internal" href="_modules/fluxfootprints/footprint_plotting.html#FootprintPlotter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.footprint_plotting.FootprintPlotter" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to handle footprint function visualization and contour extraction.</p>
<p>This class includes methods for calculating contour levels, extracting
contour boundaries, and generating footprint plots including heatmaps
and labeled isolines.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>default_colormap</strong><span class="classifier">matplotlib.colors.Colormap</span></dt><dd><p>Default colormap for footprint heatmaps (set to <cite>cm.jet</cite>).</p>
</dd>
<dt><strong>default_line_width</strong><span class="classifier">float</span></dt><dd><p>Default line width for contour lines.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#fluxfootprints.footprint_plotting.FootprintPlotter.get_contour_levels" title="fluxfootprints.footprint_plotting.FootprintPlotter.get_contour_levels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_contour_levels</span></code></a>(f, dx, dy[, rs])</p></td>
<td><p>Calculate contour levels at specified percentages of total flux contribution.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#fluxfootprints.footprint_plotting.FootprintPlotter.get_contour_vertices" title="fluxfootprints.footprint_plotting.FootprintPlotter.get_contour_vertices"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_contour_vertices</span></code></a>(x, y, f, lev)</p></td>
<td><p>Extract the (x, y) vertices of a contour line at a given footprint level.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#fluxfootprints.footprint_plotting.FootprintPlotter.plot_footprint" title="fluxfootprints.footprint_plotting.FootprintPlotter.plot_footprint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_footprint</span></code></a>(x_2d, y_2d, fs[, clevs, ...])</p></td>
<td><p>Plot the footprint heatmap and optional contour isolines.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.footprint_plotting.FootprintPlotter.get_contour_levels">
<span class="sig-name descname"><span class="pre">get_contour_levels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/fluxfootprints/footprint_plotting.html#FootprintPlotter.get_contour_levels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.footprint_plotting.FootprintPlotter.get_contour_levels" title="Link to this definition"></a></dt>
<dd><p>Calculate contour levels at specified percentages of total flux contribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>f</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>2D footprint array representing flux contributions.</p>
</dd>
<dt><strong>dx</strong><span class="classifier">float</span></dt><dd><p>Grid spacing in the x-direction (meters).</p>
</dd>
<dt><strong>dy</strong><span class="classifier">float</span></dt><dd><p>Grid spacing in the y-direction (meters).</p>
</dd>
<dt><strong>rs</strong><span class="classifier">list of float, optional</span></dt><dd><p>List of fractional cumulative contributions (e.g., [0.5, 0.8, 0.9]).
If None, defaults to np.linspace(0.10, 0.90, 9).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>list of tuple</dt><dd><p>List of tuples, each containing:
- cumulative fraction (float)
- actual integrated area under that fraction (float)
- footprint value at that contour level (float)</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The function sorts the footprint values in descending order and
calculates the contour levels that correspond to cumulative sums
of those sorted values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.footprint_plotting.FootprintPlotter.get_contour_vertices">
<span class="sig-name descname"><span class="pre">get_contour_vertices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lev</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/fluxfootprints/footprint_plotting.html#FootprintPlotter.get_contour_vertices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.footprint_plotting.FootprintPlotter.get_contour_vertices" title="Link to this definition"></a></dt>
<dd><p>Extract the (x, y) vertices of a contour line at a given footprint level.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>2D array of x-coordinate grid points.</p>
</dd>
<dt><strong>y</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>2D array of y-coordinate grid points.</p>
</dd>
<dt><strong>f</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>2D footprint array representing flux contributions.</p>
</dd>
<dt><strong>lev</strong><span class="classifier">float</span></dt><dd><p>Contour level value for which to extract vertices.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt>tuple</dt><dd><p>Tuple of two lists:
- x-coordinates of the contour vertices
- y-coordinates of the contour vertices</p>
<p>Returns (None, None) if contour is missing or touches domain boundary.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If the contour reaches the edge of the domain, it is assumed incomplete
and will be ignored.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.footprint_plotting.FootprintPlotter.plot_footprint">
<span class="sig-name descname"><span class="pre">plot_footprint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_2d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_2d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clevs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_heatmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iso_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Figure</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Axes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/fluxfootprints/footprint_plotting.html#FootprintPlotter.plot_footprint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.footprint_plotting.FootprintPlotter.plot_footprint" title="Link to this definition"></a></dt>
<dd><p>Plot the footprint heatmap and optional contour isolines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x_2d</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>2D array of x-coordinate grid points (meshgrid).</p>
</dd>
<dt><strong>y_2d</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>2D array of y-coordinate grid points (meshgrid).</p>
</dd>
<dt><strong>fs</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>2D footprint array representing flux contributions.</p>
</dd>
<dt><strong>clevs</strong><span class="classifier">list of float, optional</span></dt><dd><p>Contour levels to plot as isolines. If None, only heatmap is shown.</p>
</dd>
<dt><strong>show_heatmap</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, displays heatmap of the footprint function, by default True.</p>
</dd>
<dt><strong>normalize</strong><span class="classifier">str, optional</span></dt><dd><p>If <cite>‘log’</cite>, applies logarithmic normalization to the colormap.
Default is None.</p>
</dd>
<dt><strong>colormap</strong><span class="classifier">matplotlib.colors.Colormap, optional</span></dt><dd><p>Colormap to use for plotting. If None, uses <cite>default_colormap</cite>.</p>
</dd>
<dt><strong>line_width</strong><span class="classifier">float, optional</span></dt><dd><p>Width of contour lines, by default 0.5.</p>
</dd>
<dt><strong>iso_labels</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, displays percentage labels on contour lines, by default None.</p>
</dd>
<dt><strong>title</strong><span class="classifier">str, optional</span></dt><dd><p>Title for the plot.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>tuple</dt><dd><ul class="simple">
<li><p>matplotlib.figure.Figure object</p></li>
<li><p>matplotlib.axes.Axes object</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>A marker is placed at (0, 0) to represent the flux tower location.</p></li>
<li><p>Log-normalization is useful for emphasizing lower-magnitude fluxes.</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.footprint_plotting.add_plotting_to_footprint">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.footprint_plotting.</span></span><span class="sig-name descname"><span class="pre">add_plotting_to_footprint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FluxFootprint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/footprint_plotting.html#add_plotting_to_footprint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.footprint_plotting.add_plotting_to_footprint" title="Link to this definition"></a></dt>
<dd><p>Adds plotting methods to the FluxFootprint class.</p>
<p>This function dynamically attaches two plotting methods to a FluxFootprint class:
<cite>plot_footprint_climatology</cite> and <cite>plot_footprint_snapshot</cite>, enabling visualization
of footprint climatology and individual time-step snapshots using Matplotlib.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>FluxFootprint</strong><span class="classifier">class</span></dt><dd><p>A class representing flux footprint calculations, typically containing
methods and properties for handling xarray Datasets of footprint data.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>FluxFootprint</strong><span class="classifier">class</span></dt><dd><dl class="simple">
<dt>The input class with additional methods:</dt><dd><ul class="simple">
<li><p><cite>plot_footprint_climatology(self, ds, show_heatmap=True, title=None)</cite></p></li>
<li><p><cite>plot_footprint_snapshot(self, ds, time_index, show_heatmap=True)</cite></p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-fluxfootprints.improved_ffp">
<span id="fluxfootprints-improved-ffp-module"></span><h2>fluxfootprints.improved_ffp module<a class="headerlink" href="#module-fluxfootprints.improved_ffp" title="Link to this heading"></a></h2>
<p>Improved Flux Footprint Prediction (FFP) Module</p>
<p>This module implements the FFP model described in:
Kljun, N., P. Calanca, M.W. Rotach, H.P. Schmid, 2015:
A simple two-dimensional parameterisation for Flux Footprint Prediction (FFP).
Geosci. Model Dev. 8, 3695-3713, doi:10.5194/gmd-8-3695-2015</p>
<p>This version includes improvements for better alignment with the theoretical framework.</p>
<dl class="py class">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fluxfootprints.improved_ffp.</span></span><span class="sig-name descname"><span class="pre">FFPModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[-1000.0,</span> <span class="pre">1000.0,</span> <span class="pre">-1000.0,</span> <span class="pre">1000.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ny</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[0.1,</span> <span class="pre">0.2,</span> <span class="pre">0.3,</span> <span class="pre">0.4,</span> <span class="pre">0.5,</span> <span class="pre">0.6,</span> <span class="pre">0.7,</span> <span class="pre">0.8,</span> <span class="pre">0.9]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atm_bound_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inst_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rslayer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Flux Footprint Prediction (FFP) model based on Kljun et al. (2015).</p>
<p>This class implements an improved version of the flux footprint model
for determining the source area of scalar fluxes measured by
eddy covariance towers. It uses atmospheric stability, wind parameters,
and terrain configurations to calculate spatial footprints.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>REQUIRED_COLUMNS</strong><span class="classifier">list of str</span></dt><dd><p>Names of required columns in the input DataFrame.</p>
</dd>
<dt><strong>df</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Copy of the input DataFrame used for modeling.</p>
</dd>
<dt><strong>domain</strong><span class="classifier">list of float</span></dt><dd><p>Spatial domain defined as [xmin, xmax, ymin, ymax].</p>
</dd>
<dt><strong>fclim_2d</strong><span class="classifier">xarray.DataArray or None</span></dt><dd><p>Final footprint climatology after all processing.</p>
</dd>
<dt><strong>f_2d</strong><span class="classifier">xarray.DataArray or None</span></dt><dd><p>Instantaneous 2D footprint estimate.</p>
</dd>
<dt><strong>logger</strong><span class="classifier">logging.Logger</span></dt><dd><p>Logger instance for model-level debugging.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.apply_paper_smoothing" title="fluxfootprints.improved_ffp.FFPModel.apply_paper_smoothing"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_paper_smoothing</span></code></a>()</p></td>
<td><p>Apply 3x3 smoothing kernel from the Kljun et al. paper.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.apply_rsl_corrections" title="fluxfootprints.improved_ffp.FFPModel.apply_rsl_corrections"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_rsl_corrections</span></code></a>()</p></td>
<td><p>Apply roughness sublayer (RSL) corrections to crosswind dispersion.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_2d_footprint" title="fluxfootprints.improved_ffp.FFPModel.calc_2d_footprint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_2d_footprint</span></code></a>(f_ci_dummy, sigy_dummy)</p></td>
<td><p>Calculate the two-dimensional footprint distribution f(x,y).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_crosswind_dispersion" title="fluxfootprints.improved_ffp.FFPModel.calc_crosswind_dispersion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_crosswind_dispersion</span></code></a>(xstar_ci_dummy, px)</p></td>
<td><p>Compute dimensionless crosswind dispersion with safety checks.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_crosswind_extent" title="fluxfootprints.improved_ffp.FFPModel.calc_crosswind_extent"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_crosswind_extent</span></code></a>(r, x_ru, x_rd)</p></td>
<td><p>Calculate crosswind extent of source area using parameterized relationships.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_crosswind_integrated_extent" title="fluxfootprints.improved_ffp.FFPModel.calc_crosswind_integrated_extent"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_crosswind_integrated_extent</span></code></a>(r)</p></td>
<td><p>Calculate crosswind-integrated footprint extent for relative contribution r.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_crosswind_integrated_footprint" title="fluxfootprints.improved_ffp.FFPModel.calc_crosswind_integrated_footprint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_crosswind_integrated_footprint</span></code></a>(x_star)</p></td>
<td><p>Calculate the scaled crosswind-integrated footprint F̂y*(X̂*).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_crosswind_spread" title="fluxfootprints.improved_ffp.FFPModel.calc_crosswind_spread"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_crosswind_spread</span></code></a>(x)</p></td>
<td><p>Calculate the standard deviation of cross-wind spread <span class="math notranslate nohighlight">\(\sigma_y\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_crosswind_spread_xr" title="fluxfootprints.improved_ffp.FFPModel.calc_crosswind_spread_xr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_crosswind_spread_xr</span></code></a>(x_star)</p></td>
<td><p>Calculate the standard deviation of crosswind spread σy.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_peak_based_limits" title="fluxfootprints.improved_ffp.FFPModel.calc_peak_based_limits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_peak_based_limits</span></code></a>(r)</p></td>
<td><p>Calculate upwind and downwind distances from the peak location for fraction r.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_pi_4" title="fluxfootprints.improved_ffp.FFPModel.calc_pi_4"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_pi_4</span></code></a>()</p></td>
<td><p>Calculate Π4 with comprehensive stability function implementation including neutral conditions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_real_footprint_peak" title="fluxfootprints.improved_ffp.FFPModel.calc_real_footprint_peak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_real_footprint_peak</span></code></a>(zm, h[, u_zm, ...])</p></td>
<td><p>Calculate the real-scale footprint peak location.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_scaled_distance_rsl" title="fluxfootprints.improved_ffp.FFPModel.calc_scaled_distance_rsl"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_scaled_distance_rsl</span></code></a>()</p></td>
<td><p>Calculate scaled distance X* with roughness sublayer correction.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_scaled_footprint_peak" title="fluxfootprints.improved_ffp.FFPModel.calc_scaled_footprint_peak"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_scaled_footprint_peak</span></code></a>()</p></td>
<td><p>Calculate the scaled footprint peak location (X*max).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_scaled_x" title="fluxfootprints.improved_ffp.FFPModel.calc_scaled_x"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_scaled_x</span></code></a>(x)</p></td>
<td><p>Calculate the scaled distance X* based on wind and height parameters.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_unstable_psi" title="fluxfootprints.improved_ffp.FFPModel.calc_unstable_psi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_unstable_psi</span></code></a>(stability_param)</p></td>
<td><p>Calculate ψM for unstable atmospheric conditions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calc_xr_footprint" title="fluxfootprints.improved_ffp.FFPModel.calc_xr_footprint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_xr_footprint</span></code></a>()</p></td>
<td><p>Compute the flux footprint using xarray operations.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calculate_pi_groups" title="fluxfootprints.improved_ffp.FFPModel.calculate_pi_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_pi_groups</span></code></a>()</p></td>
<td><p>Calculate dimensionless Π groups for analysis.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.calculate_source_areas" title="fluxfootprints.improved_ffp.FFPModel.calculate_source_areas"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_source_areas</span></code></a>()</p></td>
<td><p>Compute source areas for all specified relative contributions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.check_rsl_validity" title="fluxfootprints.improved_ffp.FFPModel.check_rsl_validity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_rsl_validity</span></code></a>()</p></td>
<td><p>Check if the measurement height is above the roughness sublayer.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.check_validity_ranges" title="fluxfootprints.improved_ffp.FFPModel.check_validity_ranges"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_validity_ranges</span></code></a>()</p></td>
<td><p>Check validity ranges according to equation 27 and other constraints from Kljun et al. (2015).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.create_xr_dataset" title="fluxfootprints.improved_ffp.FFPModel.create_xr_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_xr_dataset</span></code></a>()</p></td>
<td><p>Create xarray Dataset from input DataFrame.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.define_domain" title="fluxfootprints.improved_ffp.FFPModel.define_domain"><code class="xref py py-obj docutils literal notranslate"><span class="pre">define_domain</span></code></a>()</p></td>
<td><p>Define the spatial computational domain and polar coordinate grids.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.get_scalar_value" title="fluxfootprints.improved_ffp.FFPModel.get_scalar_value"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_scalar_value</span></code></a>(arr)</p></td>
<td><p>Convert an array-like object to a scalar float value.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.get_source_area_contour" title="fluxfootprints.improved_ffp.FFPModel.get_source_area_contour"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_source_area_contour</span></code></a>(r, x_ru, x_rd, y_r)</p></td>
<td><p>Generate a contour dataset for a given source area.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.handle_stability_regimes" title="fluxfootprints.improved_ffp.FFPModel.handle_stability_regimes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">handle_stability_regimes</span></code></a>()</p></td>
<td><p>Classify stability regimes and assign model parameters based on regime.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.initialize_model_parameters" title="fluxfootprints.improved_ffp.FFPModel.initialize_model_parameters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initialize_model_parameters</span></code></a>()</p></td>
<td><p>Initialize core model parameters (a, b, c, d, ac, bc, cc).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.plot_footprint" title="fluxfootprints.improved_ffp.FFPModel.plot_footprint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_footprint</span></code></a>([config, ax, show_contours, ...])</p></td>
<td><p>Plot the footprint climatology with optional contours.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.prep_df_fields" title="fluxfootprints.improved_ffp.FFPModel.prep_df_fields"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prep_df_fields</span></code></a>(crop_height, inst_height, ...)</p></td>
<td><p>Prepare and normalize input DataFrame fields for footprint calculation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.run" title="fluxfootprints.improved_ffp.FFPModel.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>([return_result])</p></td>
<td><p>Execute the FFP model calculations.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.save_results" title="fluxfootprints.improved_ffp.FFPModel.save_results"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_results</span></code></a>(filename)</p></td>
<td><p>Save model results to a netCDF file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.scale_crosswind_dispersion" title="fluxfootprints.improved_ffp.FFPModel.scale_crosswind_dispersion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scale_crosswind_dispersion</span></code></a>(sigystar_dummy)</p></td>
<td><p>Scale the dimensionless crosswind dispersion σy* to real-scale σy.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.scale_to_real_distance" title="fluxfootprints.improved_ffp.FFPModel.scale_to_real_distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scale_to_real_distance</span></code></a>(x_star)</p></td>
<td><p>Convert scaled distance to real distance using Eq.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.verify_data" title="fluxfootprints.improved_ffp.FFPModel.verify_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">verify_data</span></code></a>(data, name)</p></td>
<td><p>Verify the content and structure of a DataArray.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#fluxfootprints.improved_ffp.FFPModel.verify_results" title="fluxfootprints.improved_ffp.FFPModel.verify_results"><code class="xref py py-obj docutils literal notranslate"><span class="pre">verify_results</span></code></a>(data[, name])</p></td>
<td><p>Check for NaN or infinite values in the given data.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.REQUIRED_COLUMNS">
<span class="sig-name descname"><span class="pre">REQUIRED_COLUMNS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['sigmav',</span> <span class="pre">'ustar',</span> <span class="pre">'ol',</span> <span class="pre">'wind_dir',</span> <span class="pre">'umean']</span></em><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.REQUIRED_COLUMNS" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.apply_paper_smoothing">
<span class="sig-name descname"><span class="pre">apply_paper_smoothing</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.apply_paper_smoothing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.apply_paper_smoothing" title="Link to this definition"></a></dt>
<dd><p>Apply 3x3 smoothing kernel from the Kljun et al. paper.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>xarray.DataArray</dt><dd><p>Smoothed footprint climatology.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.apply_rsl_corrections">
<span class="sig-name descname"><span class="pre">apply_rsl_corrections</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.apply_rsl_corrections"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.apply_rsl_corrections" title="Link to this definition"></a></dt>
<dd><p>Apply roughness sublayer (RSL) corrections to crosswind dispersion.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.calc_2d_footprint">
<span class="sig-name descname"><span class="pre">calc_2d_footprint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_ci_dummy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigy_dummy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.calc_2d_footprint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.calc_2d_footprint" title="Link to this definition"></a></dt>
<dd><p>Calculate the two-dimensional footprint distribution f(x,y).</p>
<p>Implementation of Equation 10 from Kljun et al. (2015):
f(x,y) = fy(x) * (1/(sqrt(2π)σy)) * exp(-y^2/(2σy^2))</p>
<p>Where:
- fy(x) is the crosswind-integrated footprint
- σy is the standard deviation of crosswind spread
- y is the crosswind distance from the centerline</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f_ci_dummy</strong> – Crosswind-integrated footprint</p></li>
<li><p><strong>sigy_dummy</strong> – Scaled crosswind dispersion</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Two-dimensional footprint [m^-2]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.calc_crosswind_dispersion">
<span class="sig-name descname"><span class="pre">calc_crosswind_dispersion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xstar_ci_dummy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">px</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.calc_crosswind_dispersion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.calc_crosswind_dispersion" title="Link to this definition"></a></dt>
<dd><p>Compute dimensionless crosswind dispersion with safety checks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>xstar_ci_dummy</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Scaled distance.</p>
</dd>
<dt><strong>px</strong><span class="classifier">bool</span></dt><dd><p>Condition flag.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>xarray.DataArray</dt><dd><p>Dimensionless crosswind dispersion.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.calc_crosswind_extent">
<span class="sig-name descname"><span class="pre">calc_crosswind_extent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_ru</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_rd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataArray</span></span></span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.calc_crosswind_extent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.calc_crosswind_extent" title="Link to this definition"></a></dt>
<dd><p>Calculate crosswind extent of source area using parameterized relationships.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> – Relative contribution</p></li>
<li><p><strong>x_ru</strong> – Upwind distance from peak</p></li>
<li><p><strong>x_rd</strong> – Downwind distance from peak</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Crosswind extent at each distance</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.calc_crosswind_integrated_extent">
<span class="sig-name descname"><span class="pre">calc_crosswind_integrated_extent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataArray</span></span></span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.calc_crosswind_integrated_extent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.calc_crosswind_integrated_extent" title="Link to this definition"></a></dt>
<dd><p>Calculate crosswind-integrated footprint extent for relative contribution r.
Following Equations 23-25 of the paper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>r</strong> – Relative contribution (between 0.1 and 0.9)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Distance from receptor containing fraction r of footprint</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.calc_crosswind_integrated_footprint">
<span class="sig-name descname"><span class="pre">calc_crosswind_integrated_footprint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_star</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.calc_crosswind_integrated_footprint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.calc_crosswind_integrated_footprint" title="Link to this definition"></a></dt>
<dd><p>Calculate the scaled crosswind-integrated footprint F̂y*(X̂*).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x_star</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Scaled distance from the receptor.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>xarray.DataArray</dt><dd><p>The scaled crosswind-integrated footprint.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.calc_crosswind_spread">
<span class="sig-name descname"><span class="pre">calc_crosswind_spread</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.calc_crosswind_spread"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.calc_crosswind_spread" title="Link to this definition"></a></dt>
<dd><p>Calculate the standard deviation of cross-wind spread <span class="math notranslate nohighlight">\(\sigma_y\)</span>.</p>
<p>Implements Eqs. 18-19 from <em>Kljun et al., 2015</em>:</p>
<div class="math notranslate nohighlight">
\[\sigma_y^* = a_c \sqrt{\]</div>
<p>rac{b_c lvert X^*
vert^2}</p>
<blockquote>
<div><p>{1 + c_c lvert X^*</p>
</div></blockquote>
<p>vert}}</p>
<blockquote>
<div><p>sigma_y   =</p>
</div></blockquote>
<dl class="simple">
<dt>rac{sigma_y^*}{      ext{scale_const}}</dt><dd><p>; z_m ; sigma_v / u_*</p>
</dd>
</dl>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(a_c = 2.17\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(b_c = 1.66\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(c_c = 20.0\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale_const</span></code> depends on stability (see paper).</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">float or ndarray</span></dt><dd><p>Up-wind distance from the receptor [m].</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>float or ndarray</dt><dd><p>Cross-wind spread <span class="math notranslate nohighlight">\(\sigma_y\)</span> [m].</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.calc_crosswind_spread_xr">
<span class="sig-name descname"><span class="pre">calc_crosswind_spread_xr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_star</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.calc_crosswind_spread_xr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.calc_crosswind_spread_xr" title="Link to this definition"></a></dt>
<dd><p>Calculate the standard deviation of crosswind spread σy.</p>
<p>Implements Equations 18-19 from Kljun et al. (2015):
<code class="docutils literal notranslate"><span class="pre">σy*</span> <span class="pre">=</span> <span class="pre">ac</span> <span class="pre">*</span> <span class="pre">sqrt((bc</span> <span class="pre">*</span> <span class="pre">|X*|^2)/(1</span> <span class="pre">+</span> <span class="pre">cc|X*|))</span></code></p>
<p>Where ac=2.17, bc=1.66, cc=20.0 (Equation 19)</p>
<p>Real-scale σy is then obtained through:
<code class="docutils literal notranslate"><span class="pre">σy</span> <span class="pre">=</span> <span class="pre">σy*/(scale_const)</span> <span class="pre">*</span> <span class="pre">zm</span> <span class="pre">*</span> <span class="pre">σv/u*</span></code></p>
<p>Where scale_const depends on stability (Eq. not numbered in paper):
- For unstable: 1e-5|zm/L|^(-1) + 0.80
- For stable: 1e-5|zm/L|^(-1) + 0.55</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x_star</strong> (<em>float</em><em> or </em><em>array</em>) – Distance from receptor [m]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Standard deviation of crosswind spread [m]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.calc_peak_based_limits">
<span class="sig-name descname"><span class="pre">calc_peak_based_limits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">DataArray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataArray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.calc_peak_based_limits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.calc_peak_based_limits" title="Link to this definition"></a></dt>
<dd><p>Calculate upwind and downwind distances from the peak location for fraction r.
Following Eq. 26 of the paper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>r</strong> – Relative contribution (between 0.1 and 0.9)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing upwind and downwind distances from peak</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.calc_pi_4">
<span class="sig-name descname"><span class="pre">calc_pi_4</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.calc_pi_4"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.calc_pi_4" title="Link to this definition"></a></dt>
<dd><p>Calculate Π4 with comprehensive stability function implementation including neutral conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>xr.DataArray</dt><dd></dd>
<dt>Calculated Π4 values with proper neutral condition handling</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.calc_real_footprint_peak">
<span class="sig-name descname"><span class="pre">calc_real_footprint_peak</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataArray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataArray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_zm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataArray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ustar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataArray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataArray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.4</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataArray</span></span></span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.calc_real_footprint_peak"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.calc_real_footprint_peak" title="Link to this definition"></a></dt>
<dd><p>Calculate the real-scale footprint peak location.
Based on Equations 20-22 of Kljun et al. (2015).
Works with both scalar values and xarray DataArrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zm</strong> – Measurement height [m]</p></li>
<li><p><strong>h</strong> – Boundary layer height [m]</p></li>
<li><p><strong>u_zm</strong> – Mean wind speed at measurement height [m/s], optional</p></li>
<li><p><strong>ustar</strong> – Friction velocity [m/s], optional</p></li>
<li><p><strong>z0</strong> – Roughness length [m], optional</p></li>
<li><p><strong>k</strong> – von Karman constant (default=0.4)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Real distance to footprint peak [m]
Returns DataArray if inputs are DataArrays, float if inputs are scalars</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.calc_scaled_distance_rsl">
<span class="sig-name descname"><span class="pre">calc_scaled_distance_rsl</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.calc_scaled_distance_rsl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.calc_scaled_distance_rsl" title="Link to this definition"></a></dt>
<dd><p>Calculate scaled distance X* with roughness sublayer correction.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>xarray.DataArray</dt><dd><p>Corrected scaled distance.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.calc_scaled_footprint_peak">
<span class="sig-name descname"><span class="pre">calc_scaled_footprint_peak</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.calc_scaled_footprint_peak"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.calc_scaled_footprint_peak" title="Link to this definition"></a></dt>
<dd><p>Calculate the scaled footprint peak location (X*max).
Based on Equation 20 of Kljun et al. (2015).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Scaled distance to footprint peak (constant)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.calc_scaled_x">
<span class="sig-name descname"><span class="pre">calc_scaled_x</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.calc_scaled_x"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.calc_scaled_x" title="Link to this definition"></a></dt>
<dd><p>Calculate the scaled distance X* based on wind and height parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">float or ndarray</span></dt><dd><p>Upwind distance from the receptor.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>float or ndarray</dt><dd><p>Scaled distance X*.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.calc_unstable_psi">
<span class="sig-name descname"><span class="pre">calc_unstable_psi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stability_param</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.calc_unstable_psi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.calc_unstable_psi" title="Link to this definition"></a></dt>
<dd><p>Calculate ψM for unstable atmospheric conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>stability_param</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Stability parameter zm/L.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>xarray.DataArray</dt><dd><p>Stability correction ψM.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.calc_xr_footprint">
<span class="sig-name descname"><span class="pre">calc_xr_footprint</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.calc_xr_footprint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.calc_xr_footprint" title="Link to this definition"></a></dt>
<dd><p>Compute the flux footprint using xarray operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>xarray.DataArray</dt><dd><p>Climatological flux footprint.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.calculate_pi_groups">
<span class="sig-name descname"><span class="pre">calculate_pi_groups</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.calculate_pi_groups"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.calculate_pi_groups" title="Link to this definition"></a></dt>
<dd><p>Calculate dimensionless Π groups for analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>tuple of xarray.DataArray</dt><dd><p>Π₁, Π₂, Π₃, Π₄ values.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.calculate_source_areas">
<span class="sig-name descname"><span class="pre">calculate_source_areas</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.calculate_source_areas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.calculate_source_areas" title="Link to this definition"></a></dt>
<dd><p>Compute source areas for all specified relative contributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>dict</dt><dd><p>Dictionary of contour datasets by contribution level.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.check_rsl_validity">
<span class="sig-name descname"><span class="pre">check_rsl_validity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.check_rsl_validity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.check_rsl_validity" title="Link to this definition"></a></dt>
<dd><p>Check if the measurement height is above the roughness sublayer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>pandas.Series</dt><dd><p>Boolean mask of valid rows.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.check_validity_ranges">
<span class="sig-name descname"><span class="pre">check_validity_ranges</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.check_validity_ranges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.check_validity_ranges" title="Link to this definition"></a></dt>
<dd><p>Check validity ranges according to equation 27 and other constraints from Kljun et al. (2015).</p>
<p>Implements the following validity checks:
1. Height validity (Eq. 27): 20z₀ &lt; zm &lt; he</p>
<blockquote>
<div><p>where he ≈ 0.8h is the entrainment height</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Stability validity (Eq. 27): -15.5 ≤ zm/L</p></li>
<li><p>Turbulence validity: u* &gt; 0.1 m/s, σv &gt; 0</p></li>
<li><p>Roughness sublayer validity: zm &gt; z* ≈ n*hrs
where hrs ≈ 10z₀ and 2 ≤ n ≤ 5 (Section 2)</p></li>
</ol>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>xr.Dataset: Dataset containing boolean masks for:</dt><dd></dd>
</dl>
<ul class="simple">
<li><dl class="simple">
<dt>height_valid: True where 20z₀ &lt; zm &lt; he</dt><dd></dd>
</dl>
</li>
<li><dl class="simple">
<dt>stability_valid: True where -15.5 ≤ zm/L</dt><dd></dd>
</dl>
</li>
<li><dl class="simple">
<dt>turbulence_valid: True where u* &gt; 0.1 and σv &gt; 0</dt><dd></dd>
</dl>
</li>
<li><dl class="simple">
<dt>rsl_valid: True where measurement height above RSL</dt><dd></dd>
</dl>
</li>
</ul>
<dl class="simple">
<dt>Combined validity is stored in self.valid_footprint</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.create_xr_dataset">
<span class="sig-name descname"><span class="pre">create_xr_dataset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.create_xr_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.create_xr_dataset" title="Link to this definition"></a></dt>
<dd><p>Create xarray Dataset from input DataFrame.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.define_domain">
<span class="sig-name descname"><span class="pre">define_domain</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.define_domain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.define_domain" title="Link to this definition"></a></dt>
<dd><p>Define the spatial computational domain and polar coordinate grids.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.get_scalar_value">
<span class="sig-name descname"><span class="pre">get_scalar_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.get_scalar_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.get_scalar_value" title="Link to this definition"></a></dt>
<dd><p>Convert an array-like object to a scalar float value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>arr</strong><span class="classifier">array-like or scalar</span></dt><dd><p>The value to be converted.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>float</dt><dd><p>A scalar representation of the input.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.get_source_area_contour">
<span class="sig-name descname"><span class="pre">get_source_area_contour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_ru</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_rd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_r</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.get_source_area_contour"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.get_source_area_contour" title="Link to this definition"></a></dt>
<dd><p>Generate a contour dataset for a given source area.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>r</strong><span class="classifier">float</span></dt><dd><p>Relative contribution (0 &lt; r &lt; 1).</p>
</dd>
<dt><strong>x_ru</strong><span class="classifier">float</span></dt><dd><p>Upwind distance.</p>
</dd>
<dt><strong>x_rd</strong><span class="classifier">float</span></dt><dd><p>Downwind distance.</p>
</dd>
<dt><strong>y_r</strong><span class="classifier">float</span></dt><dd><p>Crosswind extent.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>xarray.Dataset</dt><dd><p>Contour dataset with coordinates and footprint values.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.handle_stability_regimes">
<span class="sig-name descname"><span class="pre">handle_stability_regimes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.handle_stability_regimes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.handle_stability_regimes" title="Link to this definition"></a></dt>
<dd><p>Classify stability regimes and assign model parameters based on regime.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>xarray.Dataset</dt><dd><p>Dataset with regime-specific masks.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.initialize_model_parameters">
<span class="sig-name descname"><span class="pre">initialize_model_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.initialize_model_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.initialize_model_parameters" title="Link to this definition"></a></dt>
<dd><p>Initialize core model parameters (a, b, c, d, ac, bc, cc).
Ensures scalar values are assigned.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.plot_footprint">
<span class="sig-name descname"><span class="pre">plot_footprint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_contours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.plot_footprint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.plot_footprint" title="Link to this definition"></a></dt>
<dd><p>Plot the footprint climatology with optional contours.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> – Configuration object containing metadata (optional)</p></li>
<li><p><strong>ax</strong> – Matplotlib axis to plot on (optional)</p></li>
<li><p><strong>show_contours</strong> – Whether to show contour lines</p></li>
<li><p><strong>levels</strong> – Number of contour levels or list of levels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>matplotlib.figure.Figure, matplotlib.axes.Axes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.prep_df_fields">
<span class="sig-name descname"><span class="pre">prep_df_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crop_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inst_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atm_bound_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.prep_df_fields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.prep_df_fields" title="Link to this definition"></a></dt>
<dd><p>Prepare and normalize input DataFrame fields for footprint calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>crop_height</strong><span class="classifier">float</span></dt><dd><p>Vegetation height.</p>
</dd>
<dt><strong>inst_height</strong><span class="classifier">float</span></dt><dd><p>Instrument height.</p>
</dd>
<dt><strong>atm_bound_height</strong><span class="classifier">float</span></dt><dd><p>Atmospheric boundary layer height.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dataset</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.run" title="Link to this definition"></a></dt>
<dd><p>Execute the FFP model calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>return_result</strong> – If True, returns complete results dataset</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset containing footprint results</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[xr.Dataset]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.save_results">
<span class="sig-name descname"><span class="pre">save_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.save_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.save_results" title="Link to this definition"></a></dt>
<dd><p>Save model results to a netCDF file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> – Path where the results should be saved</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.scale_crosswind_dispersion">
<span class="sig-name descname"><span class="pre">scale_crosswind_dispersion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigystar_dummy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.scale_crosswind_dispersion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.scale_crosswind_dispersion" title="Link to this definition"></a></dt>
<dd><p>Scale the dimensionless crosswind dispersion σy* to real-scale σy.</p>
<p>Implements the real-scale conversion described in Equations 12-13 and surrounding text
of Kljun et al. (2015):</p>
<p>σy = σy*/(scale_const) * zm * σv/u*</p>
<p>where:
- σy* is dimensionless crosswind dispersion
- scale_const is stability-dependent scaling factor:</p>
<blockquote>
<div><p>For L ≤ 0 (convective): scale_const = min(1, 10⁻⁵|zm/L|⁻¹ + 0.80)
For L &gt; 0 (stable): scale_const = min(1, 10⁻⁵|zm/L|⁻¹ + 0.55)</p>
</div></blockquote>
<ul class="simple">
<li><p>zm is measurement height</p></li>
<li><p>σv is standard deviation of lateral velocity fluctuations</p></li>
<li><p>u* is friction velocity</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sigystar_dummy</strong> (<em>xarray.DataArray</em>) – Dimensionless crosswind dispersion σy*</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Real-scale crosswind dispersion σy [m]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Includes numerical safety checks to prevent division by zero and handle
potential non-finite values in intermediate calculations.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.scale_to_real_distance">
<span class="sig-name descname"><span class="pre">scale_to_real_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_star</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataArray</span></span></span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.scale_to_real_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.scale_to_real_distance" title="Link to this definition"></a></dt>
<dd><p>Convert scaled distance to real distance using Eq. 6/7.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x_star</strong> – Scaled distance X*</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Real-scale distance</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.verify_data">
<span class="sig-name descname"><span class="pre">verify_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.verify_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.verify_data" title="Link to this definition"></a></dt>
<dd><p>Verify the content and structure of a DataArray.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">xarray.DataArray</span></dt><dd><p>Data array to check.</p>
</dd>
<dt><strong>name</strong><span class="classifier">str</span></dt><dd><p>Variable name for logging.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>bool</dt><dd><p>True if valid, False otherwise.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fluxfootprints.improved_ffp.FFPModel.verify_results">
<span class="sig-name descname"><span class="pre">verify_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'data'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/improved_ffp.html#FFPModel.verify_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.improved_ffp.FFPModel.verify_results" title="Link to this definition"></a></dt>
<dd><p>Check for NaN or infinite values in the given data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">array-like or xarray.DataArray</span></dt><dd><p>The data to verify.</p>
</dd>
<dt><strong>name</strong><span class="classifier">str, optional</span></dt><dd><p>Descriptive name for logging.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-fluxfootprints.tools">
<span id="fluxfootprints-tools-module"></span><h2>fluxfootprints.tools module<a class="headerlink" href="#module-fluxfootprints.tools" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.tools.aggregate_to_daily_centroid">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.tools.</span></span><span class="sig-name descname"><span class="pre">aggregate_to_daily_centroid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Timestamp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'X'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Y'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/tools.html#aggregate_to_daily_centroid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.tools.aggregate_to_daily_centroid" title="Link to this definition"></a></dt>
<dd><p>Aggregate sub-daily coordinate data to daily centroids.</p>
<p>This function groups coordinate data by calendar date and computes the
centroid of X and Y values. If <cite>weighted=True</cite>, centroids are computed
using a weighted average based on the ‘ET’ (evapotranspiration) column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Input DataFrame containing timestamps and coordinate columns.</p>
</dd>
<dt><strong>date_column</strong><span class="classifier">str, optional</span></dt><dd><p>Name of the column with datetime objects, by default “Timestamp”.</p>
</dd>
<dt><strong>x_column</strong><span class="classifier">str, optional</span></dt><dd><p>Name of the column representing X coordinates, by default “X”.</p>
</dd>
<dt><strong>y_column</strong><span class="classifier">str, optional</span></dt><dd><p>Name of the column representing Y coordinates, by default “Y”.</p>
</dd>
<dt><strong>weighted</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, uses the ‘ET’ column as weights for centroid calculation;
otherwise computes an unweighted mean. Default is True.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pandas.DataFrame</dt><dd><p>DataFrame with one row per date and columns for:
- <cite>‘Date’</cite>: datetime.date object
- <cite>x_column</cite>: daily centroid X coordinate
- <cite>y_column</cite>: daily centroid Y coordinate</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Requires a column named <cite>‘ET’</cite> if <cite>weighted=True</cite>.</p></li>
<li><p>Assumes the timestamp column can be parsed with <cite>pd.to_datetime</cite>.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.tools.concat_fetch_gdf">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.tools.</span></span><span class="sig-name descname"><span class="pre">concat_fetch_gdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5070</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/tools.html#concat_fetch_gdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.tools.concat_fetch_gdf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.tools.generate_density_raster">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.tools.</span></span><span class="sig-name descname"><span class="pre">generate_density_raster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5070</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ET'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/tools.html#generate_density_raster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.tools.generate_density_raster" title="Link to this definition"></a></dt>
<dd><p>Generate a weighted kernel density raster from a point GeoDataFrame.</p>
<p>This function uses a Gaussian kernel density estimation (KDE) to create a raster
from spatial point data, where each point is weighted by a specified attribute
(e.g., evapotranspiration). The output raster is georeferenced with an affine
transform and buffered beyond the point extent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>gdf</strong><span class="classifier">geopandas.GeoDataFrame</span></dt><dd><p>Input GeoDataFrame containing point geometries and a weight field.</p>
</dd>
<dt><strong>resolution</strong><span class="classifier">float, optional</span></dt><dd><p>Size of each raster cell in projection units (typically meters),
by default 50.</p>
</dd>
<dt><strong>buffer_distance</strong><span class="classifier">float, optional</span></dt><dd><p>Distance to extend the raster beyond the extent of the points, in the same
units as the CRS (e.g., meters), by default 200.</p>
</dd>
<dt><strong>epsg</strong><span class="classifier">int, optional</span></dt><dd><p>EPSG code for the output coordinate reference system, by default 5070
(NAD83 / Conus Albers).</p>
</dd>
<dt><strong>weight_field</strong><span class="classifier">str, optional</span></dt><dd><p>Name of the column in <cite>gdf</cite> to use as weights in the KDE calculation,
by default “ET”.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>density</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>2D array of KDE density values (not normalized by default).</p>
</dd>
<dt><strong>transform</strong><span class="classifier">affine.Affine</span></dt><dd><p>Affine transformation mapping array coordinates to geographic space.</p>
</dd>
<dt><strong>bounds</strong><span class="classifier">tuple of float</span></dt><dd><p>Bounding box of the raster extent as (xmin, ymin, xmax, ymax).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This function assumes that the input geometries are point features.</p></li>
<li><p>The returned density array is not normalized unless the line
<cite>density /= np.sum(density)</cite> is uncommented.</p></li>
<li><p>The output CRS is set using <cite>gdf.to_crs(epsg=…)</cite>.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.tools.impute_evapotranspiration">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.tools.</span></span><span class="sig-name descname"><span class="pre">impute_evapotranspiration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ET'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ET'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/tools.html#impute_evapotranspiration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.tools.impute_evapotranspiration" title="Link to this definition"></a></dt>
<dd><p>Impute missing data in a half-hourly evapotranspiration time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pd.DataFrame</em>) – DataFrame with a datetime index and a column ‘ET’ containing evapotranspiration data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame with missing values imputed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.tools.polar_to_cartesian_dataframe">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.tools.</span></span><span class="sig-name descname"><span class="pre">polar_to_cartesian_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wd_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'WD'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Dist'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/tools.html#polar_to_cartesian_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.tools.polar_to_cartesian_dataframe" title="Link to this definition"></a></dt>
<dd><p>Convert polar coordinates in a DataFrame to Cartesian coordinates.</p>
<p>This function adds Cartesian coordinate columns (<cite>X_&lt;dist_column&gt;</cite> and
<cite>Y_&lt;dist_column&gt;</cite>) to the input DataFrame based on polar inputs defined
by wind direction (in degrees from North) and radial distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Input DataFrame containing polar coordinate columns.</p>
</dd>
<dt><strong>wd_column</strong><span class="classifier">str, optional</span></dt><dd><p>Name of the column representing wind direction in degrees from North,
by default “WD”.</p>
</dd>
<dt><strong>dist_column</strong><span class="classifier">str, optional</span></dt><dd><p>Name of the column representing distance from origin,
by default “Dist”.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pandas.DataFrame</dt><dd><p>Modified DataFrame with two new columns:
- <cite>‘X_&lt;dist_column&gt;’</cite>: Cartesian X coordinate
- <cite>‘Y_&lt;dist_column&gt;’</cite>: Cartesian Y coordinate</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function treats <cite>-9999</cite> and <cite>NaN</cite> as missing values.</p></li>
<li><p>Wind direction is converted such that 0° = North, 90° = East, etc.</p></li>
<li><p>Cartesian conversion is performed using:
<cite>X = dist * cos(θ)</cite> and <cite>Y = dist * sin(θ)</cite> where θ = (90 - WD) in degrees.</p></li>
</ul>
</dd></dl>

</section>
<section id="module-fluxfootprints.volk">
<span id="fluxfootprints-volk-module"></span><h2>fluxfootprints.volk module<a class="headerlink" href="#module-fluxfootprints.volk" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.volk.calc_hourly_ffp">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.volk.</span></span><span class="sig-name descname"><span class="pre">calc_hourly_ffp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">startdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'2022-01-01'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">secrets_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'../../secrets/config.ini'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5070</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zm_s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin_d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/volk.html#calc_hourly_ffp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.volk.calc_hourly_ffp" title="Link to this definition"></a></dt>
<dd><p>Calculate and write hourly footprint climatologies for an eddy‑covariance
station.</p>
<p>The routine fetches meteorological and flux data, applies the Kljun et al.
(2015) footprint model for every valid hour starting at <em>startdate</em>, and
stores the results as daily multi‑band GeoTIFFs (each band = one hour).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>station</strong><span class="classifier">str</span></dt><dd><p>Site identifier used to locate configuration and observational data.</p>
</dd>
<dt><strong>startdate</strong><span class="classifier">str, optional</span></dt><dd><p>First day to query data (<code class="docutils literal notranslate"><span class="pre">&quot;YYYY‑MM‑DD&quot;</span></code>).  Default is
<code class="docutils literal notranslate"><span class="pre">&quot;2022‑01‑01&quot;</span></code>.</p>
</dd>
<dt><strong>out_dir</strong><span class="classifier">str or pathlib.Path, optional</span></dt><dd><p>Destination directory for the daily <code class="docutils literal notranslate"><span class="pre">*_weighted.tif</span></code> rasters.  If
<em>None</em>, a folder named <code class="docutils literal notranslate"><span class="pre">footprints</span></code> is created next to the script.</p>
</dd>
<dt><strong>config_path</strong><span class="classifier">str or pathlib.Path, optional</span></dt><dd><p>Path to a station configuration file containing metadata
(latitude, longitude, elevation, tower height).</p>
</dd>
<dt><strong>secrets_path</strong><span class="classifier">str or pathlib.Path, optional</span></dt><dd><p>INI file holding database credentials.  Default is
<code class="docutils literal notranslate"><span class="pre">&quot;../../secrets/config.ini&quot;</span></code>.</p>
</dd>
<dt><strong>epsg</strong><span class="classifier">int, optional</span></dt><dd><p>EPSG code for the target projection; default is <code class="docutils literal notranslate"><span class="pre">5070</span></code> (NAD83 / CONUS
Albers).</p>
</dd>
<dt><strong>h_c</strong><span class="classifier">float, optional</span></dt><dd><p>Mean canopy height <em>h&lt;sub&gt;c&lt;/sub&gt;</em> [m].  Default is <code class="docutils literal notranslate"><span class="pre">0.2</span></code>.</p>
</dd>
<dt><strong>zm_s</strong><span class="classifier">float, optional</span></dt><dd><p>Measurement height above ground <em>zₘ</em> [m].  Default is <code class="docutils literal notranslate"><span class="pre">2.0</span></code>.</p>
</dd>
<dt><strong>dx</strong><span class="classifier">float, optional</span></dt><dd><p>Spatial resolution of the footprint grid [m].  Default is <code class="docutils literal notranslate"><span class="pre">3.0</span></code>.</p>
</dd>
<dt><strong>h_s</strong><span class="classifier">float, optional</span></dt><dd><p>Assumed boundary‑layer height <em>hₛ</em> [m].  Default is <code class="docutils literal notranslate"><span class="pre">2000.0</span></code>.</p>
</dd>
<dt><strong>origin_d</strong><span class="classifier">float, optional</span></dt><dd><p>Half‑width of the model domain (origin ± <em>origin_d</em>) [m].  Default is
<code class="docutils literal notranslate"><span class="pre">200.0</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd><p>The function writes GeoTIFFs to <em>out_dir</em> and returns no value.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>A day is processed only when ≥ 5 hourly records are valid.</p></li>
<li><p>Existing raster files are <strong>not</strong> overwritten.</p></li>
<li><p>Calculations use data between 06:00 and 20:00 local time.</p></li>
<li><p>Errors during an hourly run are logged and that hour is skipped.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calc_hourly_ffp</span><span class="p">(</span><span class="s2">&quot;US-UTW&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Run in parallel for several stations:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">multiprocessing</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">mp</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">calc_hourly_ffp</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;US-UTW&quot;</span><span class="p">,</span> <span class="s2">&quot;US-XYZ&quot;</span><span class="p">,</span> <span class="s2">&quot;US-ABC&quot;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.volk.calc_hourly_ffp_xr">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.volk.</span></span><span class="sig-name descname"><span class="pre">calc_hourly_ffp_xr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">years</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/volk.html#calc_hourly_ffp_xr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.volk.calc_hourly_ffp_xr" title="Link to this definition"></a></dt>
<dd><p>Compute hourly ASCE reference evapotranspiration (ETo/ETr) for a set of
<strong>gridded</strong> meteorological NetCDF files and append the results to each file.</p>
<p>For every year in <em>years</em> the routine</p>
<ol class="arabic simple">
<li><p>Opens <code class="docutils literal notranslate"><span class="pre">&quot;&lt;year&gt;_utah_merged.nc&quot;</span></code> from <em>input_data_dir</em> as an
<code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code>.</p></li>
<li><p>Derives meteorological fields required by <strong>RefET</strong> (air temperature in
°C, actual vapor pressure <em>kPa</em>, wind speed m s⁻¹, short‑wave radiation
W m⁻²).</p></li>
<li><p>Calculates hourly ETo and ETr with <a href="#id1"><span class="problematic" id="id2">:pyclass:`refet.Hourly`</span></a> for an
elevation range of 1 100 – 1 975 m (25 m steps).</p></li>
<li><p>Stores the resulting 4‑D arrays in the dataset as <code class="docutils literal notranslate"><span class="pre">ETo</span></code> and <code class="docutils literal notranslate"><span class="pre">ETr</span></code>
(dimensions <code class="docutils literal notranslate"><span class="pre">elevation,</span> <span class="pre">time,</span> <span class="pre">lat,</span> <span class="pre">lon</span></code>).</p></li>
<li><p>Writes the augmented dataset to
<code class="docutils literal notranslate"><span class="pre">&quot;&lt;year&gt;_with_eto.nc&quot;</span></code> in <em>output_dir</em>.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_data_dir</strong><span class="classifier">str or pathlib.Path, optional</span></dt><dd><p>Directory that contains the yearly NetCDF files
<code class="docutils literal notranslate"><span class="pre">&quot;&lt;year&gt;_utah_merged.nc&quot;</span></code>.  Defaults to the current working
directory.</p>
</dd>
<dt><strong>years</strong><span class="classifier">list of int, optional</span></dt><dd><p>Years to process.  If <em>None</em> the default list
<code class="docutils literal notranslate"><span class="pre">[2021,</span> <span class="pre">2022,</span> <span class="pre">2023,</span> <span class="pre">2024]</span></code> is used.</p>
</dd>
<dt><strong>output_dir</strong><span class="classifier">str or pathlib.Path, optional</span></dt><dd><p>Destination directory for the <code class="docutils literal notranslate"><span class="pre">*_with_eto.nc</span></code> files.  If <em>None</em>,
the original <em>input_data_dir</em> is used.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd><p>The function writes one NetCDF file per year and does not return a
Python object.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Elevations span <strong>1 100 m to 1 975 m a.s.l.</strong> in 25 m increments,
producing 36 elevation layers.</p></li>
<li><p>Meteorological variable names in the input files must be</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Tair</span></code>  [K] – air temperature</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PSurf</span></code> [Pa] – surface pressure</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Qair</span></code> – specific humidity (kg kg⁻¹)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Wind_E</span></code> / <code class="docutils literal notranslate"><span class="pre">Wind_N</span></code> – east‐ and north‑component wind (m s⁻¹)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SWdown</span></code> [W m⁻²] – incident short‑wave radiation</p></li>
</ul>
</li>
<li><p><strong>Units</strong>: output ETo/ETr are in millimetres per hour (<code class="docutils literal notranslate"><span class="pre">mm/hour</span></code>).</p></li>
<li><p>The function prints each year to stdout as a simple progress indicator.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc_hourly_ffp_xr</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">input_data_dir</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/data/met/&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">years</span><span class="o">=</span><span class="p">[</span><span class="mi">2022</span><span class="p">,</span> <span class="mi">2023</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">output_dir</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/data/met/eto/&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.volk.calc_nldas_refet">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.volk.</span></span><span class="sig-name descname"><span class="pre">calc_nldas_refet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hour</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nldas_out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elevation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zm</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/volk.html#calc_nldas_refet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.volk.calc_nldas_refet" title="Link to this definition"></a></dt>
<dd><p>Normalize hourly ETo values by day and station using min-max and sum-based scaling.</p>
<p>This function adds two new normalized columns to an input ETo DataFrame:
- <cite>daily_min_max_ETo</cite>: Min-max normalized hourly ETo (0–1 range within each day).
- <cite>daily_ETo_normed</cite>: Sum-normalized values such that daily total equals 1 (unitless weights).</p>
<p>The normalization is applied only to hours between 6 AM and 6 PM (inclusive), and the
results are merged back into the original DataFrame. Missing values are filled with 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>eto_df</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>DataFrame containing at least a datetime index or column, an ETo column, and a
‘stationid’ index or column. Typically produced from NLDAS extraction routines.</p>
</dd>
<dt><strong>eto_field</strong><span class="classifier">str, optional</span></dt><dd><p>Column name in <cite>eto_df</cite> containing the ETo values to normalize. Default is “eto”.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pandas.DataFrame</dt><dd><p>Original DataFrame with two new columns added:
- ‘daily_min_max_ETo’
- ‘daily_ETo_normed’</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Time window: normalization is applied only between 6:00 and 18:00 (local time).</p></li>
<li><p>Grouping is performed on both ‘stationid’ and calendar date.</p></li>
<li><p><cite>daily_ETo_normed</cite> values are set to 0 outside the time window or when insufficient data exists.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">norm_df</span> <span class="o">=</span> <span class="n">normalize_eto_df</span><span class="p">(</span><span class="n">eto_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm_df</span><span class="p">[[</span><span class="s2">&quot;eto&quot;</span><span class="p">,</span> <span class="s2">&quot;daily_ETo_normed&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.volk.clip_to_utah_merge">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.volk.</span></span><span class="sig-name descname"><span class="pre">clip_to_utah_merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./NLDAS_data/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">years</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/volk.html#clip_to_utah_merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.volk.clip_to_utah_merge" title="Link to this definition"></a></dt>
<dd><p>Clip NLDAS NetCDF files to Utah boundaries and merge them by year.</p>
<p>This function scans a directory for NetCDF files corresponding to the specified <cite>years</cite>,
extracts data within the geographic bounds of Utah, and merges the resulting subsets
along the time dimension. Outputs are saved in both NetCDF and Parquet formats.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>file_dir</strong><span class="classifier">str or pathlib.Path, optional</span></dt><dd><p>Directory containing NLDAS NetCDF files. Defaults to “./NLDAS_data/”.</p>
</dd>
<dt><strong>years</strong><span class="classifier">list of int, optional</span></dt><dd><p>List of years to process. If None, defaults to [2022, 2023, 2024].</p>
</dd>
<dt><strong>output_dir</strong><span class="classifier">str or pathlib.Path, optional</span></dt><dd><p>Directory to store the output files. Defaults to “./”.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd><p>This function writes files to disk but does not return anything.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Latitude bounds for Utah: 37.0 to 42.0</p></li>
<li><p>Longitude bounds for Utah: -114.0 to -109.0</p></li>
<li><p>Files are merged by year using <cite>xarray.concat</cite> on the <cite>time</cite> dimension.</p></li>
<li><dl class="simple">
<dt>Output filenames:</dt><dd><ul>
<li><p>NetCDF:  <cite>&lt;year&gt;_utah_merged.nc</cite></p></li>
<li><p>Parquet: <cite>&lt;year&gt;_utah_merged.parquet</cite></p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">clip_to_utah_merge</span><span class="p">(</span><span class="n">file_dir</span><span class="o">=</span><span class="s2">&quot;./NLDAS_data/&quot;</span><span class="p">,</span> <span class="n">years</span><span class="o">=</span><span class="p">[</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">2022</span><span class="p">],</span> <span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;./outputs/&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.volk.download_nldas">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.volk.</span></span><span class="sig-name descname"><span class="pre">download_nldas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">date</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">datetime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hour</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ed_user</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ed_pass</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/volk.html#download_nldas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.volk.download_nldas" title="Link to this definition"></a></dt>
<dd><p>Download a single-hour NLDAS forcing dataset in NetCDF format.</p>
<p>This function downloads a specific hourly NLDAS (North American Land Data Assimilation System)
forcing product file from NASA GES DISC for a given date and hour using Earthdata credentials.
The file is saved in a local <cite>NLDAS_data/</cite> directory and is skipped if it already exists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>date</strong><span class="classifier">datetime.date or datetime.datetime</span></dt><dd><p>Date of the file to download.</p>
</dd>
<dt><strong>hour</strong><span class="classifier">int</span></dt><dd><p>Hour of the file to download (0 to 23).</p>
</dd>
<dt><strong>ed_user</strong><span class="classifier">str</span></dt><dd><p>Earthdata username for NASA GES DISC authentication.</p>
</dd>
<dt><strong>ed_pass</strong><span class="classifier">str</span></dt><dd><p>Earthdata password for authentication.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd><p>This function saves a NetCDF file to disk and does not return a value.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Files are saved to the <cite>NLDAS_data/</cite> directory as: <cite>YYYY_MM_DD_HH.nc</cite>.</p></li>
<li><p>The function uses a two-step request process to handle Earthdata login redirection.</p></li>
<li><p>If the file already exists locally, it will not be re-downloaded.</p></li>
<li><p>File format: NetCDF (<cite>.nc</cite>) from the NLDAS_FORA0125_H.2.0 collection.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.volk.extract_nldas_xr_to_df">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.volk.</span></span><span class="sig-name descname"><span class="pre">extract_nldas_xr_to_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">years</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'../../station_config/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">secrets_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'../../secrets/config.ini'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./output/'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/volk.html#extract_nldas_xr_to_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.volk.extract_nldas_xr_to_df" title="Link to this definition"></a></dt>
<dd><p>Extract and compile NLDAS-derived timeseries for multiple stations into a single DataFrame.</p>
<p>This function processes NLDAS datasets (in NetCDF format with ETo, ETr, and related variables)
for specified years, extracts values for multiple stations based on their configuration <cite>.ini</cite>
files, and writes the result to a Parquet file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>years</strong><span class="classifier">list of int</span></dt><dd><p>List of years for which NLDAS NetCDF files (with ETo included) will be processed.</p>
</dd>
<dt><strong>input_path</strong><span class="classifier">str or pathlib.Path, optional</span></dt><dd><p>Directory containing NetCDF input files named like <cite>&lt;year&gt;_with_eto.nc</cite>.</p>
</dd>
<dt><strong>config_path</strong><span class="classifier">str or pathlib.Path, optional</span></dt><dd><p>Directory containing station <cite>.ini</cite> configuration files (e.g., <cite>US-UTW.ini</cite>) with keys
like latitude, longitude, and elevation.</p>
</dd>
<dt><strong>secrets_path</strong><span class="classifier">str or pathlib.Path, optional</span></dt><dd><p>Path to the secrets/config file used by the <cite>load_configs</cite> function.</p>
</dd>
<dt><strong>output_path</strong><span class="classifier">str or pathlib.Path, optional</span></dt><dd><p>Directory to save the output Parquet file. Default is <cite>./output/</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd><p>Writes a single Parquet file (<cite>nldas_all.parquet</cite>) containing hourly time series data
indexed by station ID and datetime.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The function uses <cite>xarray</cite> to open NetCDF files and <cite>pandas</cite> to store time series data.</p></li>
<li><p>It finds the nearest spatial point in the dataset for each station’s lat/lon/elevation.</p></li>
<li><p>Extracted variables include: ETo, ETr, PotEvap, LWdown, SWdown, Tair, Qair, PSurf,
Wind_E, and Wind_N (converted to total wind speed).</p></li>
<li><p>Output columns: [‘eto’, ‘etr’, ‘pet’, ‘lwdown’, ‘swdown’, ‘temperature’,
‘rh’, ‘pressure’, ‘wind’].</p></li>
<li><p>Time is converted to local time by subtracting 7 hours from UTC.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.volk.fetch_and_preprocess_data">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.volk.</span></span><span class="sig-name descname"><span class="pre">fetch_and_preprocess_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">startdate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/volk.html#fetch_and_preprocess_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.volk.fetch_and_preprocess_data" title="Link to this definition"></a></dt>
<dd><p>Retrieve and preprocess AmeriFlux eddy covariance data for a given station.</p>
<p>Queries a remote database for flux data starting from a specified date and
performs basic preprocessing, including timestamp parsing, resampling, and
handling of missing values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>url</strong><span class="classifier">str</span></dt><dd><p>Base URL of the database API.</p>
</dd>
<dt><strong>station</strong><span class="classifier">str</span></dt><dd><p>Station identifier string (e.g., site code or station ID).</p>
</dd>
<dt><strong>startdate</strong><span class="classifier">str</span></dt><dd><p>Starting date (ISO format: ‘YYYY-MM-DD’) for data retrieval.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>df</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>Preprocessed DataFrame indexed by timestamp and containing hourly-averaged
flux variables. Empty if retrieval fails.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Replaces <cite>-9999</cite> with <cite>NaN</cite> for missing values.</p></li>
<li><p>Drops rows where critical variables (‘h2o’, ‘wd’, ‘ustar’, ‘v_sigma’) are missing.</p></li>
<li><p>Resamples to hourly means using <cite>numeric_only=True</cite>.</p></li>
<li><p>Assumes the API conforms to a PostgREST-style filtering syntax.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.volk.find_transform">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.volk.</span></span><span class="sig-name descname"><span class="pre">find_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/volk.html#find_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.volk.find_transform" title="Link to this definition"></a></dt>
<dd><p>Compute an affine transform for georeferencing from 2D coordinate arrays.</p>
<p>Given two 2D arrays of x and y coordinates representing a spatial grid, this
function calculates the affine transformation matrix that maps array indices
to real-world coordinates using three control points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>xs</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>2D array of x-coordinate values (same shape as <cite>ys</cite>).</p>
</dd>
<dt><strong>ys</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>2D array of y-coordinate values (same shape as <cite>xs</cite>).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>aff_transform</strong><span class="classifier">affine.Affine</span></dt><dd><p>Affine transformation object mapping array indices to spatial coordinates.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uses <cite>cv2.getAffineTransform</cite> to calculate the transform from three grid points.</p></li>
<li><p>The top-left, top-right, and bottom-left corners are used as control points.</p></li>
<li><p>Useful for writing raster data with spatial referencing in rasterio.</p></li>
<li><p>Assumes that <cite>xs</cite> and <cite>ys</cite> represent a regularly gridded spatial surface.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">aff</span> <span class="o">=</span> <span class="n">find_transform</span><span class="p">(</span><span class="n">x_grid</span><span class="p">,</span> <span class="n">y_grid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">aff</span><span class="p">)</span>
<span class="go">Affine(2.0, 0.0, 300000.0,</span>
<span class="go">       0.0, -2.0, 4100000.0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.volk.load_configs">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.volk.</span></span><span class="sig-name descname"><span class="pre">load_configs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'../../station_config/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">secrets_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'../../secrets/config.ini'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/volk.html#load_configs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.volk.load_configs" title="Link to this definition"></a></dt>
<dd><p>Load station metadata and secrets from configuration files.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.volk.mask_fp_cutoff">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.volk.</span></span><span class="sig-name descname"><span class="pre">mask_fp_cutoff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/volk.html#mask_fp_cutoff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.volk.mask_fp_cutoff" title="Link to this definition"></a></dt>
<dd><p>Mask all values in a footprint array outside the cumulative contribution cutoff.</p>
<p>This function applies a cumulative contribution threshold to a footprint array,
keeping only the highest values that together sum to the specified <cite>cutoff</cite>
fraction of the total. All other values are set to a small constant near zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>f_array</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>2D array of footprint contribution values (unitless).</p>
</dd>
<dt><strong>cutoff</strong><span class="classifier">float, optional</span></dt><dd><p>Fraction of the cumulative footprint to retain (default is 0.9 for 90%).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>numpy.ndarray</dt><dd><p>2D array where values below the cutoff threshold are replaced with a small
near-zero constant (<cite>0.0</cite>), and values above the threshold are retained.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The cutoff is applied based on the sorted cumulative sum of all values.</p></li>
<li><p>Values below the determined threshold are set to <cite>0.0</cite>, not NaN, to avoid
issues in downstream raster calculations.</p></li>
<li><p>This function is useful for visualizing or focusing on the core area of a
footprint (e.g., 90% contribution area).</p></li>
<li><p>Uses a logarithmic debug message to record the computed threshold.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">masked</span> <span class="o">=</span> <span class="n">mask_fp_cutoff</span><span class="p">(</span><span class="n">footprint_array</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">masked</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">150  # Number of grid cells contributing to 80% of the flux</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.volk.multiply_directories_rast">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.volk.</span></span><span class="sig-name descname"><span class="pre">multiply_directories_rast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ensemble'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/volk.html#multiply_directories_rast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.volk.multiply_directories_rast" title="Link to this definition"></a></dt>
<dd><p>Multiply matching GeoTIFF rasters from two directories based on dates in their
filenames.</p>
<p>This function searches for GeoTIFF files in two directories (<code class="docutils literal notranslate"><span class="pre">dir1</span></code> and
<code class="docutils literal notranslate"><span class="pre">dir2</span></code>) that share a common date string in the format <code class="docutils literal notranslate"><span class="pre">&quot;YYYY_MM_DD&quot;</span></code>. It
multiplies pairs of rasters with <a class="reference internal" href="#fluxfootprints.volk.multiply_geotiffs" title="fluxfootprints.volk.multiply_geotiffs"><code class="xref py py-func docutils literal notranslate"><span class="pre">multiply_geotiffs()</span></code></a> and saves the
results to <code class="docutils literal notranslate"><span class="pre">out_dir</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>dir1</strong><span class="classifier">pathlib.Path or str, optional</span></dt><dd><p>Directory containing the first set of GeoTIFF files, typically with
filenames ending in <code class="docutils literal notranslate"><span class="pre">&quot;_weighted.tif&quot;</span></code>.  Defaults to
<code class="docutils literal notranslate"><span class="pre">&quot;./output/usutw/&quot;</span></code>.</p>
</dd>
<dt><strong>dir2</strong><span class="classifier">pathlib.Path or str, optional</span></dt><dd><p>Directory containing the second set of GeoTIFF files, typically with
filenames starting with <code class="docutils literal notranslate"><span class="pre">&quot;ensemble_et_&quot;</span></code>.  Defaults to
<code class="docutils literal notranslate"><span class="pre">&quot;G:/My</span> <span class="pre">Drive/OpenET</span> <span class="pre">Exports/&quot;</span></code>.</p>
</dd>
<dt><strong>out_dir</strong><span class="classifier">pathlib.Path or str, optional</span></dt><dd><p>Output directory where the resulting multiplied rasters will be saved.
If the directory does not exist, it is created.  Defaults to
<code class="docutils literal notranslate"><span class="pre">&quot;./output/usutw_mult/&quot;</span></code>.</p>
</dd>
<dt><strong>model</strong><span class="classifier">str, optional</span></dt><dd><p>Name of the model used to identify files in <code class="docutils literal notranslate"><span class="pre">dir2</span></code>.  Must match the
file‑naming pattern (e.g., <code class="docutils literal notranslate"><span class="pre">&quot;ensemble&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;eemetric&quot;</span></code>, or
<code class="docutils literal notranslate"><span class="pre">&quot;ssebop&quot;</span></code>).  Default is <code class="docutils literal notranslate"><span class="pre">&quot;ensemble&quot;</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>dict</dt><dd><p>Mapping of <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code> objects (derived from the matched
date strings) to the result returned by <a class="reference internal" href="#fluxfootprints.volk.multiply_geotiffs" title="fluxfootprints.volk.multiply_geotiffs"><code class="xref py py-func docutils literal notranslate"><span class="pre">multiply_geotiffs()</span></code></a> for
each raster pair.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Only files with matching <code class="docutils literal notranslate"><span class="pre">&quot;YYYY_MM_DD&quot;</span></code> date strings in both
directories are processed.</p></li>
<li><p>Filenames in <code class="docutils literal notranslate"><span class="pre">dir2</span></code> must start with <code class="docutils literal notranslate"><span class="pre">&quot;{model}_et_&quot;</span></code> followed by the
date.</p></li>
<li><p>Files without a matching pair in the other directory are skipped.</p></li>
<li><p>Output filenames are formatted
<code class="docutils literal notranslate"><span class="pre">&quot;weighted_{model}_openet_{YYYY_MM_DD}.tif&quot;</span></code>.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">multiply_directories_rast</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">dir1</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./output/usutw/&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">dir2</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;G:/My Drive/OpenET Exports/&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">out_dir</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./output/usutw_mult/&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;ensemble&quot;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span><span class="mi">2</span><span class="p">]</span>
<span class="go">[Timestamp(&#39;2021-03-05 00:00:00&#39;), Timestamp(&#39;2021-03-06 00:00:00&#39;)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.volk.multiply_geotiffs">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.volk.</span></span><span class="sig-name descname"><span class="pre">multiply_geotiffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/volk.html#multiply_geotiffs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.volk.multiply_geotiffs" title="Link to this definition"></a></dt>
<dd><p>Multiply two GeoTIFF rasters after aligning them to the same CRS, extent, and resolution.</p>
<p>This function opens two input rasters, reprojects the second raster to match the spatial
properties of the first, multiplies them element-wise (handling NoData values gracefully),
and writes the result to a new output raster file. It also prints and returns the sum of the
resulting raster values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_a</strong><span class="classifier">str or pathlib.Path</span></dt><dd><p>Path to the first GeoTIFF file. This raster is used as the spatial reference.</p>
</dd>
<dt><strong>input_b</strong><span class="classifier">str or pathlib.Path</span></dt><dd><p>Path to the second GeoTIFF file. This raster is reprojected to match <cite>input_a</cite>.</p>
</dd>
<dt><strong>output_path</strong><span class="classifier">str or pathlib.Path</span></dt><dd><p>Path where the output multiplied raster will be saved.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>float</dt><dd><p>The sum of the values in the output raster, excluding masked (NoData) values.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The CRS, resolution, extent, and transform of <cite>input_b</cite> are matched to those of <cite>input_a</cite>
using bilinear resampling.</p></li>
<li><p>The multiplication respects the NoData mask of <cite>input_a</cite>.</p></li>
<li><p>The resulting raster uses the data type of <cite>input_a</cite> and writes NoData areas as zeros.</p></li>
<li><p>The output raster is written as a single-band GeoTIFF.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">total</span> <span class="o">=</span> <span class="n">multiply_geotiffs</span><span class="p">(</span><span class="s2">&quot;a.tif&quot;</span><span class="p">,</span> <span class="s2">&quot;b.tif&quot;</span><span class="p">,</span> <span class="s2">&quot;output_mult.tif&quot;</span><span class="p">)</span>
<span class="go">Output saved to: output_mult.tif</span>
<span class="go">Sum of raster values: 123456.78</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.volk.norm_dly_et">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.volk.</span></span><span class="sig-name descname"><span class="pre">norm_dly_et</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/volk.html#norm_dly_et"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.volk.norm_dly_et" title="Link to this definition"></a></dt>
<dd><p>Normalize daily evapotranspiration values by their sum.</p>
<p>This function scales input values so that their sum equals 1, useful for generating
relative daily weights. The result is rounded to 4 decimal places.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">pandas.Series or numpy.ndarray</span></dt><dd><p>One-dimensional array or series of daily ET values.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>numpy.ndarray</dt><dd><p>Array of normalized values summing to 1, rounded to 4 decimal places.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If the sum of <cite>x</cite> is zero, the result will contain <cite>NaN</cite> or <cite>inf</cite> values.</p></li>
<li><p>Ensure input is non-negative and non-empty for meaningful results.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm_dly_et</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]))</span>
<span class="go">array([0.167, 0.333, 0.5  ])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.volk.norm_minmax_dly_et">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.volk.</span></span><span class="sig-name descname"><span class="pre">norm_minmax_dly_et</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/volk.html#norm_minmax_dly_et"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.volk.norm_minmax_dly_et" title="Link to this definition"></a></dt>
<dd><p>Apply min-max normalization to a series of daily evapotranspiration values.</p>
<p>This function scales input values linearly to the [0, 1] range using min-max normalization,
then rounds the results to 4 decimal places.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">pandas.Series or numpy.ndarray</span></dt><dd><p>One-dimensional array or series of daily ET values.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>numpy.ndarray</dt><dd><p>Normalized array of values between 0 and 1, rounded to 4 decimals.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If all values in <cite>x</cite> are equal, the result will be <cite>NaN</cite> due to division by zero.</p></li>
<li><p>This function does not handle missing values explicitly; ensure <cite>x</cite> is clean beforehand.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">2.1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm_minmax_dly_et</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">array([0.   , 0.267, 0.6  , 1.   ])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.volk.normalize_eto_df">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.volk.</span></span><span class="sig-name descname"><span class="pre">normalize_eto_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eto_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eto_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eto'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/volk.html#normalize_eto_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.volk.normalize_eto_df" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.volk.outline_valid_cells">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.volk.</span></span><span class="sig-name descname"><span class="pre">outline_valid_cells</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/volk.html#outline_valid_cells"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.volk.outline_valid_cells" title="Link to this definition"></a></dt>
<dd><p>Extract and outline the valid data extent of a raster as polygons.</p>
<p>This function reads a raster file and identifies all non-nodata or non-NaN cells
as valid. It then constructs vector polygons outlining the spatial extent of
these valid regions. The result is returned as a GeoDataFrame and can optionally
be saved to a GeoJSON file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>raster_path</strong><span class="classifier">str or pathlib.Path</span></dt><dd><p>Path to the input raster file (e.g., GeoTIFF).</p>
</dd>
<dt><strong>out_file</strong><span class="classifier">str or pathlib.Path, optional</span></dt><dd><p>Path to save the resulting polygon geometry as a GeoJSON file.
If None (default), the result is not saved to disk.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>geopandas.GeoDataFrame</dt><dd><p>A GeoDataFrame containing one or more polygons representing the extent
of valid cells. If multiple regions exist, they are dissolved into a single
geometry.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If the raster has a defined <cite>nodata</cite> value, cells with this value are treated as invalid.</p></li>
<li><p>If no <cite>nodata</cite> is defined, the function uses NaN to identify invalid cells.</p></li>
<li><p>The output geometry is in the same CRS as the input raster.</p></li>
<li><p>Output is dissolved into one polygon using <cite>union_all()</cite> to form a contiguous boundary.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gdf</span> <span class="o">=</span> <span class="n">outline_valid_cells</span><span class="p">(</span><span class="s2">&quot;elevation.tif&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">outline_valid_cells</span><span class="p">(</span><span class="s2">&quot;et_2022.tif&quot;</span><span class="p">,</span> <span class="n">out_file</span><span class="o">=</span><span class="s2">&quot;valid_extent.geojson&quot;</span><span class="p">)</span>
<span class="go">Saved valid extent polygons to &#39;valid_extent.geojson&#39;.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.volk.read_compiled_input">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.volk.</span></span><span class="sig-name descname"><span class="pre">read_compiled_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/fluxfootprints/volk.html#read_compiled_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.volk.read_compiled_input" title="Link to this definition"></a></dt>
<dd><p>Load a CSV file that contains pre‑compiled inputs for flux‑footprint
modelling, validate its contents, and return the cleaned data.</p>
<p>The routine</p>
<ol class="arabic simple">
<li><p>reads the file into a <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>;</p></li>
<li><p>parses the index as <code class="docutils literal notranslate"><span class="pre">datetime</span></code> and resamples to <strong>hourly</strong> means;</p></li>
<li><p>verifies that every required variable is present;</p></li>
<li><p>drops rows in which any required value is missing; and</p></li>
<li><p>extracts site latitude/longitude from the first row.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>path</strong><span class="classifier">str or pathlib.Path</span></dt><dd><p>Path to the CSV file containing the pre‑processed input data.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>tuple[pandas.DataFrame, float, float] or None</dt><dd></dd>
<dt><em>If</em> the file is valid, a tuple <code class="docutils literal notranslate"><span class="pre">(df,</span> <span class="pre">latitude,</span> <span class="pre">longitude)</span></code></dt><dd></dd>
<dt>If required variables are missing or the file cannot be parsed,</dt><dd></dd>
<dt>the function returns <code class="docutils literal notranslate"><span class="pre">None</span></code>.</dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><strong>Variables that *must* be present</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">latitude</span></code>, <code class="docutils literal notranslate"><span class="pre">longitude</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ET_corr</span></code>                    – corrected evapotranspiration</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wind_dir</span></code>, <code class="docutils literal notranslate"><span class="pre">u_star</span></code>, <code class="docutils literal notranslate"><span class="pre">sigma_v</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">zm</span></code> (measurement height), <code class="docutils literal notranslate"><span class="pre">hc</span></code> (canopy height),
<code class="docutils literal notranslate"><span class="pre">d</span></code> (displacement height), <code class="docutils literal notranslate"><span class="pre">L</span></code> (Obukhov length)</p></li>
<li><p><em>Either</em> <code class="docutils literal notranslate"><span class="pre">u_mean</span></code> (mean wind speed) <em>or</em> <code class="docutils literal notranslate"><span class="pre">z0</span></code> (roughness length)</p></li>
</ul>
<p><strong>Optional columns that are retained if present</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">IGBP_land_classification</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">secondary_veg_type</span></code></p></li>
</ul>
<p>The data are resampled with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
<p>and any hourly row still missing a required value is dropped.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="o">=</span> <span class="n">read_compiled_input</span><span class="p">(</span><span class="s2">&quot;inputs/station_data.csv&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
<span class="go">Index([&#39;latitude&#39;, &#39;longitude&#39;, &#39;ET_corr&#39;, &#39;wind_dir&#39;, &#39;u_star&#39;, &#39;sigma_v&#39;,</span>
<span class="go">       &#39;zm&#39;, &#39;hc&#39;, &#39;d&#39;, &#39;L&#39;, &#39;u_mean&#39;],</span>
<span class="go">      dtype=&#39;object&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.volk.reproject_raster_dir">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.volk.</span></span><span class="sig-name descname"><span class="pre">reproject_raster_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_epsg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'EPSG:5070'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/volk.html#reproject_raster_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.volk.reproject_raster_dir" title="Link to this definition"></a></dt>
<dd><p>Reproject all GeoTIFF files in a directory to a specified EPSG coordinate system.</p>
<p>This function reads all <cite>.tif</cite> files in the input directory, reprojects them to the
specified coordinate reference system (CRS), and saves the reprojected rasters to
the output directory using the same filenames.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_folder</strong><span class="classifier">str or pathlib.Path</span></dt><dd><p>Path to the directory containing input GeoTIFF files.</p>
</dd>
<dt><strong>output_folder</strong><span class="classifier">str or pathlib.Path</span></dt><dd><p>Path to the directory where reprojected GeoTIFF files will be saved.
If the directory does not exist, it will be created.</p>
</dd>
<dt><strong>target_epsg</strong><span class="classifier">str, optional</span></dt><dd><p>EPSG code of the target CRS (e.g., “EPSG:5070”). Default is “EPSG:5070”.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd><p>The function performs file I/O but does not return any value.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uses Rasterio for reading, writing, and reprojecting GeoTIFF files.</p></li>
<li><p>Reprojection uses <cite>Resampling.nearest</cite> for band resampling.</p></li>
<li><p>Target transform, width, and height are calculated using <cite>calculate_default_transform</cite>.</p></li>
<li><p>The output raster preserves the number of bands and data type from the input.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reproject_raster_dir</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">input_folder</span><span class="o">=</span><span class="s2">&quot;./input_rasters&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">output_folder</span><span class="o">=</span><span class="s2">&quot;./output_rasters&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">target_epsg</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">Reprojected ./input_rasters/file1.tif → ./output_rasters/file1.tif</span>
<span class="go">Reprojected ./input_rasters/file2.tif → ./output_rasters/file2.tif</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.volk.snap_centroid">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.volk.</span></span><span class="sig-name descname"><span class="pre">snap_centroid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">station_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/fluxfootprints/volk.html#snap_centroid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.volk.snap_centroid" title="Link to this definition"></a></dt>
<dd><p>Snap station coordinates to the nearest odd multiple of 15 within a 30-meter grid.</p>
<p>This function adjusts a UTM coordinate pair <cite>(station_x, station_y)</cite> such that the
resulting point aligns with a 30-meter grid cell and lands on an odd multiple of 15.
This helps ensure symmetry and minimizes distortion in gridded analysis (e.g., for
raster-based footprint modeling).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>station_x</strong><span class="classifier">float</span></dt><dd><p>Original x-coordinate (e.g., UTM Easting) of the station.</p>
</dd>
<dt><strong>station_y</strong><span class="classifier">float</span></dt><dd><p>Original y-coordinate (e.g., UTM Northing) of the station.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>tuple of float</dt><dd><p>The adjusted <cite>(x, y)</cite> coordinates snapped to the appropriate grid centroid.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The adjustment ensures that both <cite>x</cite> and <cite>y</cite> are centered on a 30-meter grid.</p></li>
<li><p>Coordinates are snapped to the nearest <strong>odd multiple of 15</strong> to avoid aligning
exactly with grid cell edges.</p></li>
<li><p>This function is particularly useful for aligning station locations to raster grids
for flux footprint or land surface model analysis.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x_adj</span><span class="p">,</span> <span class="n">y_adj</span> <span class="o">=</span> <span class="n">snap_centroid</span><span class="p">(</span><span class="mf">435627.3</span><span class="p">,</span> <span class="mf">4512322.7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x_adj</span><span class="p">,</span> <span class="n">y_adj</span><span class="p">)</span>
<span class="go">435630.0 4512322.5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.volk.weighted_rasters">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.volk.</span></span><span class="sig-name descname"><span class="pre">weighted_rasters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stationid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'US-UTW'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_hr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normed_NLDAS_stats_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nldas_all_normed.parquet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/volk.html#weighted_rasters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.volk.weighted_rasters" title="Link to this definition"></a></dt>
<dd><p>Generate daily weighted footprint rasters based on hourly fetch and normalized ETo data.
This function reads a Parquet file containing daily normalized ETo values for multiple
stations, filters it by the specified station ID, and applies hourly weighting to existing
footprint rasters. For each unweighted TIFF file in <cite>out_dir</cite>, the function:
1. Parses the date from the filename.
2. Reads hourly bands from the raster, normalizes them by their global sum, and multiplies by the normalized ETo value for that hour.
3. Sums these hourly weighted rasters into a single daily footprint raster.
4. Writes the result to a new file named <cite>&lt;YYYY-MM-DD&gt;_weighted.tif</cite> in <cite>out_dir</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>stationid</strong><span class="classifier">str, optional</span></dt><dd><p>Station identifier used to look up normalized ETo values (default: ‘US-UTW’).</p>
</dd>
<dt><strong>start_hr</strong><span class="classifier">int, optional</span></dt><dd><p>Starting hour for the data slice (default: 6, i.e. 7 AM).</p>
</dd>
<dt><strong>end_hr</strong><span class="classifier">int, optional</span></dt><dd><p>Ending hour for the data slice (default: 18, i.e. 8 PM).</p>
</dd>
<dt><strong>normed_NLDAS_stats_path</strong><span class="classifier">str or pathlib.Path, optional</span></dt><dd><p>Path to the Parquet file containing normalized ETo data (default: ‘nldas_all_normed.parquet’).</p>
</dd>
<dt><strong>out_dir</strong><span class="classifier">str or pathlib.Path, optional</span></dt><dd><p>Output directory containing unweighted footprint rasters (default: current directory).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd><p>This function does not return anything. It writes a single-band, daily-weighted footprint
raster to <cite>out_dir</cite> for each processed date.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Any TIFF files in <cite>out_dir</cite> with filenames starting with ‘20’ (e.g., ‘2022-01-01.tif’) are processed, unless they already contain the substring ‘weighted’ in their filename.</p></li>
<li><p>The function expects the TIFF filename to be in the form ‘YYYY-MM-DD.tif’ so it can parse out the date.</p></li>
<li><p>Only generates a weighted TIFF file if the total sum of the final footprint is within 0.15 of 1.0.</p></li>
<li><p>Hourly rasters with all NaN values are replaced with zeros.</p></li>
<li><p>Written rasters preserve the same georeferencing, resolution, and coordinate reference system as the input rasters.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fluxfootprints.volk.write_footprint_to_raster">
<span class="sig-prename descclassname"><span class="pre">fluxfootprints.volk.</span></span><span class="sig-name descname"><span class="pre">write_footprint_to_raster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">footprints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5070</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fluxfootprints/volk.html#write_footprint_to_raster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fluxfootprints.volk.write_footprint_to_raster" title="Link to this definition"></a></dt>
<dd><p>Write hourly footprint climatologies to a multi‑band GeoTIFF raster.</p>
<p>Each band in the output GeoTIFF corresponds to one hourly footprint.  The
function encodes the footprint array (<code class="docutils literal notranslate"><span class="pre">f_2d</span></code>) and annotates each band
with metadata that includes the hour and the total flux‑footprint sum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>footprints</strong><span class="classifier">list of tuple</span></dt><dd><p>List of tuples in the form <code class="docutils literal notranslate"><span class="pre">(hour,</span> <span class="pre">f_2d,</span> <span class="pre">x_2d,</span> <span class="pre">y_2d)</span></code> where</p>
<ul class="simple">
<li><p><strong>hour</strong> (<em>int</em>) – Hour of the day (24‑hour clock).</p></li>
<li><p><strong>f_2d</strong> (<em>numpy.ndarray</em>) – 2‑D footprint values.</p></li>
<li><p><strong>x_2d</strong> (<em>numpy.ndarray</em>) – 2‑D array of <em>x</em> coordinates.</p></li>
<li><p><strong>y_2d</strong> (<em>numpy.ndarray</em>) – 2‑D array of <em>y</em> coordinates.</p></li>
</ul>
</dd>
<dt><strong>output_path</strong><span class="classifier">pathlib.Path or str</span></dt><dd><p>Destination path for the output GeoTIFF.</p>
</dd>
<dt><strong>epsg</strong><span class="classifier">int, optional</span></dt><dd><p>EPSG code for the coordinate reference system.  Default is <code class="docutils literal notranslate"><span class="pre">5070</span></code>
(NAD83 / Conus Albers).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None</dt><dd><p>The function writes a file to disk and returns no value.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Every band is labeled with the hour (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;0800&quot;</span></code>) and its total
footprint sum.</p></li>
<li><p>Uses <a class="reference internal" href="#fluxfootprints.volk.find_transform" title="fluxfootprints.volk.find_transform"><code class="xref py py-func docutils literal notranslate"><span class="pre">find_transform()</span></code></a> on <code class="docutils literal notranslate"><span class="pre">(y_2d,</span> <span class="pre">x_2d)</span></code> to build the affine
transform.</p></li>
<li><p>Output raster is <code class="docutils literal notranslate"><span class="pre">float64</span></code> with a no‑data value of <code class="docutils literal notranslate"><span class="pre">0.0</span></code>.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">footprints</span></code> is empty, no file is written and a log message is
emitted.</p></li>
</ul>
</dd></dl>

</section>
<section id="module-fluxfootprints">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-fluxfootprints" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="fluxfootprint documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="modules.html" class="btn btn-neutral float-right" title="fluxfootprints" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Paul Inkenbrandt, Natascha Kljun, John Volk.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
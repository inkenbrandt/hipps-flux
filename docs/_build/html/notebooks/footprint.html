

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Running Footprint Code &mdash; fluxfootprint 0.1.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=92734c54"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="&lt;no title&gt;" href="row_footprint.html" />
    <link rel="prev" title="Outline of Flux Measurement Footprint Estimation Approaches" href="../modeltypes.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            fluxfootprint
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../fluxfootprints.html">fluxfootprints package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">fluxfootprints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exp.html">Flux Footprints: Key Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modeltypes.html">Outline of Flux Measurement Footprint Estimation Approaches</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quick-start notebook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Import-Libraries">Import Libraries</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">fluxfootprint</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Running Footprint Code</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/footprint.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Running-Footprint-Code">
<h1>Running Footprint Code<a class="headerlink" href="#Running-Footprint-Code" title="Link to this heading"></a></h1>
<section id="Import-Libraries">
<h2>Import Libraries<a class="headerlink" href="#Import-Libraries" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">rasterio</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyproj</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fluxdataqaqc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Data</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rasterio.plot</span><span class="w"> </span><span class="kn">import</span> <span class="n">show</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;../../src/&quot;</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">fluxfootprints</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fluxfootprints</span><span class="w"> </span><span class="kn">import</span> <span class="n">FFPModel</span> <span class="k">as</span> <span class="n">ffp</span>

<span class="c1">#import utm</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:1607: SyntaxWarning: invalid escape sequence &#39;\s&#39;
  &#34;&#34;&#34;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stat_data</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="s1">&#39;US-UTE.ini&#39;</span><span class="p">)</span>
<span class="n">stat_data</span><span class="o">.</span><span class="n">out_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../../data/station_config/output&#39;</span><span class="p">)</span>
<span class="n">stat_data</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;MO_LENGTH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;MO_LENGTH&#39;</span>
<span class="n">stat_data</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;USTAR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;USTAR&#39;</span>
<span class="n">stat_data</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;V_SIGMA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;V_SIGMA&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">stat_data</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">stat_data</span><span class="o">.</span><span class="n">inv_map</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Calculating mean for var: THETA from columns: [&#39;SWC_1_1_1&#39;, &#39;SWC_2_1_1&#39;]
WARNING: renaming column G to input_G
WARNING: renaming column LE to input_LE
WARNING: renaming column H to input_H
Converting vpd from hpa to kpa
Calculating vapor pressure from vapor pressure deficit and air temperature
Calculating dew point temperature from vapor pressure
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\pandas\core\arraylike.py:399: RuntimeWarning: invalid value encountered in log
  result = getattr(ufunc, method)(*inputs, **kwargs)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">latitude</span> <span class="o">=</span> <span class="n">stat_data</span><span class="o">.</span><span class="n">latitude</span>
<span class="n">longitude</span> <span class="o">=</span> <span class="n">stat_data</span><span class="o">.</span><span class="n">longitude</span>
<span class="n">station_coord</span> <span class="o">=</span> <span class="p">(</span><span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">)</span>
<span class="c1"># get EPSG code from lat,long, convert to UTM https://epsg.io/32617</span>
<span class="c1">#EPSG=32700-np.round((45+latitude)/90.0)*100+np.round((-183+longitude)/6.0)</span>
<span class="n">EPSG</span> <span class="o">=</span> <span class="mi">5070</span>
<span class="c1">#utm_coords = utm.from_latlon(latitude, longitude)</span>

<span class="n">transformer</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">Transformer</span><span class="o">.</span><span class="n">from_crs</span><span class="p">(</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;EPSG:</span><span class="si">{</span><span class="n">EPSG</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="n">station_y</span><span class="p">,</span> <span class="n">station_x</span><span class="p">)</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="o">*</span><span class="n">station_coord</span><span class="p">)</span>
<span class="n">station</span> <span class="o">=</span> <span class="n">stat_data</span><span class="o">.</span><span class="n">site_id</span>
<span class="p">(</span><span class="n">station_y</span><span class="p">,</span> <span class="n">station_x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(-1353156.22180492, 1744260.286299747)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
37.7353 -111.5708
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Other model parameters</span>
<span class="n">h_c</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1">#Height of canopy [m]</span>
<span class="c1"># Estimated displacement height [m]</span>
<span class="n">d</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">0.979</span><span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">h_c</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.154</span><span class="p">)</span>

<span class="n">zm_s</span> <span class="o">=</span> <span class="mf">2.</span> <span class="c1">#Measurement height [m] from AMF metadata</span>
<span class="n">h_s</span> <span class="o">=</span> <span class="mf">2000.</span> <span class="c1">#Height of atmos. boundary layer [m] - assumed</span>
<span class="n">dx</span> <span class="o">=</span> <span class="mf">3.</span> <span class="c1">#Model resolution [m]</span>
<span class="n">origin_d</span> <span class="o">=</span> <span class="mf">200.</span> <span class="c1">#Model bounds distance from origin [m]</span>
<span class="c1"># from 7 AM to 8 PM only, modify if needed</span>
<span class="n">start_hr</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">end_hr</span> <span class="o">=</span> <span class="mi">18</span>
<span class="n">hours</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start_hr</span><span class="p">,</span><span class="n">end_hr</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#Loop through each day in the dataframe</span>
<span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">date</span><span class="p">[:</span><span class="mi">10</span><span class="p">]:</span>

    <span class="c1">#Subset dataframe to only values in day of year</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Date: </span><span class="si">{</span><span class="n">date</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">temp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">date</span> <span class="o">==</span> <span class="n">date</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">hour</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">hours</span><span class="p">))]</span>

    <span class="n">new_dat</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">indx</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">hours</span><span class="p">):</span>

        <span class="n">band</span> <span class="o">=</span> <span class="n">indx</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Hour: </span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">temp_line</span> <span class="o">=</span> <span class="n">temp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">temp_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">hour</span> <span class="o">==</span> <span class="n">t</span><span class="p">,:]</span>

            <span class="c1">#Calculate footprint</span>
            <span class="n">ffp_out</span> <span class="o">=</span> <span class="n">ffp</span><span class="p">(</span><span class="n">temp_line</span><span class="p">,</span>
                          <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">origin_d</span><span class="p">,</span><span class="n">origin_d</span><span class="p">,</span><span class="o">-</span><span class="n">origin_d</span><span class="p">,</span><span class="n">origin_d</span><span class="p">],</span>
                          <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span>
                          <span class="n">zm</span><span class="o">=</span><span class="n">zm_s</span><span class="o">-</span><span class="n">d</span><span class="p">,</span>
                          <span class="n">h</span><span class="o">=</span><span class="n">h_s</span><span class="p">,</span>
                          <span class="n">rs</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">temp_line</span><span class="p">),</span>
                          <span class="n">z0</span><span class="o">=</span><span class="n">h_c</span><span class="o">*</span><span class="mf">.123</span><span class="p">,</span>
                          <span class="n">ol</span><span class="o">=</span><span class="n">temp_line</span><span class="p">[</span><span class="s1">&#39;MO_LENGTH&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                          <span class="n">sigmav</span><span class="o">=</span><span class="n">temp_line</span><span class="p">[</span><span class="s1">&#39;V_SIGMA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                          <span class="n">ustar</span><span class="o">=</span><span class="n">temp_line</span><span class="p">[</span><span class="s1">&#39;USTAR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="c1">#umean=temp_line[&#39;ws&#39;].values,</span>
                          <span class="n">wind_dir</span><span class="o">=</span><span class="n">temp_line</span><span class="p">[</span><span class="s1">&#39;wd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                          <span class="n">crop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                          <span class="n">fig</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                          <span class="n">verbosity</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="c1">####verbosoity=2 prints out errors; if z0 triggers errors, use umean</span>
            <span class="c1">#    print(zm_s-d)</span>
            <span class="n">temp_ffp</span> <span class="o">=</span> <span class="n">ffp_out</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
            <span class="n">f_2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp_ffp</span><span class="p">[</span><span class="s1">&#39;fclim_2d&#39;</span><span class="p">])</span>
            <span class="n">x_2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp_ffp</span><span class="p">[</span><span class="s1">&#39;x_2d&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="n">station_x</span>
            <span class="n">y_2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">temp_ffp</span><span class="p">[</span><span class="s1">&#39;y_2d&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="n">station_y</span>
            <span class="n">f_2d</span> <span class="o">=</span> <span class="n">f_2d</span><span class="o">*</span><span class="n">dx</span><span class="o">**</span><span class="mi">2</span>

            <span class="c1">#Calculate affine transform for given x_2d and y_2d</span>
            <span class="n">affine_transform</span> <span class="o">=</span> <span class="n">ffp</span><span class="o">.</span><span class="n">find_transform</span><span class="p">(</span><span class="n">y_2d</span><span class="p">,</span><span class="n">x_2d</span><span class="p">)</span>

            <span class="c1">#Create data file if not already created</span>
            <span class="k">if</span> <span class="n">new_dat</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">out_f</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;../../data/station_config/output/a</span><span class="si">{</span><span class="n">date</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">station</span><span class="si">}</span><span class="s2">.tif&quot;</span>
                <span class="c1">#out_f = f&#39;../../station_config/output/a{date}_{station}.tif&#39;</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">f_2d</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                <span class="n">new_dat</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">out_f</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">driver</span><span class="o">=</span><span class="s1">&#39;GTiff&#39;</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">rasterio</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span>
                                        <span class="n">count</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">hours</span><span class="p">),</span><span class="n">height</span><span class="o">=</span><span class="n">f_2d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">width</span><span class="o">=</span><span class="n">f_2d</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                        <span class="n">transform</span><span class="o">=</span><span class="n">affine_transform</span><span class="p">,</span>
                                        <span class="n">crs</span><span class="o">=</span><span class="n">transformer</span><span class="o">.</span><span class="n">target_crs</span><span class="p">,</span>
                                        <span class="n">nodata</span><span class="o">=</span><span class="mf">0.00000000e+000</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Hour </span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s1"> footprint failed, band </span><span class="si">{</span><span class="n">band</span><span class="si">}</span><span class="s1"> not written.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="n">temp_ffp</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">continue</span>

        <span class="c1">#Mask out points that are below a % threshold (defaults to 90%)</span>
        <span class="n">f_2d</span> <span class="o">=</span> <span class="n">ffp</span><span class="o">.</span><span class="n">mask_fp_cutoff</span><span class="p">(</span><span class="n">f_2d</span><span class="p">)</span>

        <span class="c1">#Write the new band</span>
        <span class="n">new_dat</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f_2d</span><span class="p">,</span><span class="n">indx</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1">#Update tags with metadata</span>
        <span class="n">tag_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;hour&#39;</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">t</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">04</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;wind_dir&#39;</span><span class="p">:</span><span class="n">temp_line</span><span class="p">[</span><span class="s1">&#39;wd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                    <span class="s1">&#39;total_footprint&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">(</span><span class="n">f_2d</span><span class="p">)}</span>

        <span class="n">new_dat</span><span class="o">.</span><span class="n">update_tags</span><span class="p">(</span><span class="n">indx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="o">**</span><span class="n">tag_dict</span><span class="p">)</span>

    <span class="c1">#Close dataset if it exists</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">new_dat</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">continue</span>

    <span class="nb">print</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2025-05-07 13:35:07,193 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:07,196 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:07,196 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:07,197 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:07,201 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:07,202 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,242 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,243 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,244 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,244 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,245 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:07,247 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:07,249 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:07,250 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:07,255 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:07,256 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:07,260 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:07,262 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,277 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:07,277 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,278 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,286 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:07,288 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:07,289 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:07,289 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:07,292 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:07,293 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,321 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,323 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,324 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,326 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,327 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:07,331 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:07,333 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:07,337 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:07,344 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:07,347 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:07,355 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:07,356 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,360 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:07,361 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,362 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,375 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:07,378 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:07,379 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:07,381 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:07,385 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:07,386 - FFPModel - INFO - Domain setup completed successfully
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Date: 2024-06-24
Hour: 6
Hour 6 footprint failed, band 1 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 7
Hour 7 footprint failed, band 2 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 8
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,413 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,414 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,415 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,416 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,417 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:07,420 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:07,421 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:07,422 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:07,426 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:07,428 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:07,431 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:07,432 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,437 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:07,438 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,438 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,449 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:07,452 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:07,453 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:07,454 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:07,459 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:07,460 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,490 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,491 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,492 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,494 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,494 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:07,497 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:07,499 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:07,501 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:07,506 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:07,508 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:07,513 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:07,513 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,518 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:07,519 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,520 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,531 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:07,534 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:07,535 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:07,536 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:07,541 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:07,541 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,573 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,574 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,575 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,576 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,577 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:07,580 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:07,581 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:07,583 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:07,589 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:07,590 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:07,596 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:07,597 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,603 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:07,604 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,605 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,615 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:07,619 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:07,619 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:07,620 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:07,625 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:07,626 - FFPModel - INFO - Domain setup completed successfully
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 8 footprint failed, band 3 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 9
Hour 9 footprint failed, band 4 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 10
Hour 10 footprint failed, band 5 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 11
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,665 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,666 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,667 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,669 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,670 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:07,674 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:07,676 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:07,677 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:07,685 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:07,688 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:07,694 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:07,695 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,701 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:07,702 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,703 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,715 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:07,718 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:07,719 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:07,720 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:07,723 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:07,724 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,756 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,757 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,758 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,758 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,759 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:07,762 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:07,763 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:07,765 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:07,771 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:07,772 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:07,777 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:07,778 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,782 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:07,783 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,783 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,792 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:07,794 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:07,794 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:07,795 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:07,798 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:07,798 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,829 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,830 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,831 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,831 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,833 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:07,835 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:07,837 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:07,838 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:07,843 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:07,845 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:07,849 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:07,850 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,855 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:07,855 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,856 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,864 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:07,867 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:07,873 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:07,875 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:07,880 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:07,882 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:07,889 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:07,891 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:07,897 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:07,899 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:07,908 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:07,909 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:07,910 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:07,910 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:07,913 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:07,914 - FFPModel - INFO - Domain setup completed successfully
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 11 footprint failed, band 6 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 12
Hour 12 footprint failed, band 7 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 13
Hour 13 footprint failed, band 8 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 14
Hour 14 footprint failed, band 9 not written.
all rs values must be between 0 and 1
Hour: 15
Hour 15 footprint failed, band 10 not written.
all rs values must be between 0 and 1
Hour: 16
Hour 16 footprint failed, band 11 not written.
all rs values must be between 0 and 1
Hour: 17
Hour 17 footprint failed, band 12 not written.
all rs values must be between 0 and 1
Hour: 18
Hour 18 footprint failed, band 13 not written.
all rs values must be between 0 and 1
Date: 2024-06-24
Hour: 6
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,938 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,938 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,939 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,940 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:07,941 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:07,943 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:07,944 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:07,945 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:07,949 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:07,951 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:07,954 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:07,955 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,959 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:07,960 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,960 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:07,969 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:07,971 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:07,972 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:07,972 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:07,975 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:07,976 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,022 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,023 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,024 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,026 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,027 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:08,031 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:08,033 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:08,036 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:08,044 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:08,047 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:08,056 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:08,057 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,059 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:08,060 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,061 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,069 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:08,071 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:08,072 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:08,072 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:08,076 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:08,077 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,108 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,109 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,110 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,111 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,111 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:08,114 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:08,114 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:08,116 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:08,120 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:08,122 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:08,125 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:08,126 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,130 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:08,130 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,130 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,137 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:08,139 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:08,140 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:08,140 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:08,143 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:08,143 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,166 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,167 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,168 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,169 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,169 - FFPModel - INFO - strongly_stable: 0 points (nan%)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 6 footprint failed, band 1 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 7
Hour 7 footprint failed, band 2 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 8
Hour 8 footprint failed, band 3 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 9
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2025-05-07 13:35:08,172 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:08,173 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:08,174 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:08,178 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:08,179 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:08,183 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:08,184 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,189 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:08,190 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,190 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,199 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:08,201 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:08,202 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:08,202 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:08,206 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:08,206 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,231 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,232 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,233 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,234 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,235 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:08,237 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:08,239 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:08,240 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:08,244 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:08,245 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:08,248 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:08,249 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,253 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:08,253 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,254 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,261 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:08,263 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:08,264 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:08,264 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:08,267 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:08,267 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,292 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,293 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,294 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,295 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,295 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:08,298 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:08,299 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:08,300 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:08,304 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:08,306 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:08,310 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:08,310 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,314 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:08,315 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,315 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,323 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:08,325 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:08,325 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:08,326 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:08,330 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:08,330 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,364 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,364 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,365 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,366 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,367 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:08,369 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:08,371 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:08,372 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:08,376 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:08,378 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:08,382 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:08,382 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,385 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:08,386 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,387 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,394 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:08,396 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:08,397 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:08,397 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:08,400 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 9 footprint failed, band 4 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 10
Hour 10 footprint failed, band 5 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 11
Hour 11 footprint failed, band 6 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 12
Hour 12 footprint failed, band 7 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 13
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2025-05-07 13:35:08,401 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,429 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,430 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,431 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,433 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,434 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:08,437 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:08,438 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:08,440 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:08,445 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:08,447 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:08,452 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:08,453 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,456 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:08,457 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,457 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,466 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:08,469 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:08,475 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:08,477 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:08,483 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:08,486 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:08,492 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:08,494 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:08,499 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:08,501 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:08,508 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:08,511 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:08,511 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:08,512 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:08,514 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:08,514 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,540 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,541 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,541 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,542 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,543 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:08,545 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:08,546 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:08,547 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:08,551 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:08,553 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:08,556 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:08,557 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,561 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:08,562 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,562 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,569 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:08,571 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:08,571 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:08,572 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:08,575 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:08,575 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,597 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,598 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,599 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,600 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,602 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:08,605 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:08,606 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:08,608 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:08,611 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:08,613 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:08,616 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:08,618 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,620 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:08,620 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,621 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,627 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:08,629 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:08,629 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:08,630 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:08,632 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:08,633 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,659 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,660 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,661 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,662 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,663 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:08,666 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:08,667 - FFPModel - INFO - Starting footprint calculation...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 13 footprint failed, band 8 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 14
Hour 14 footprint failed, band 9 not written.
all rs values must be between 0 and 1
Hour: 15
Hour 15 footprint failed, band 10 not written.
all rs values must be between 0 and 1
Hour: 16
Hour 16 footprint failed, band 11 not written.
all rs values must be between 0 and 1
Hour: 17
Hour 17 footprint failed, band 12 not written.
all rs values must be between 0 and 1
Hour: 18
Hour 18 footprint failed, band 13 not written.
all rs values must be between 0 and 1
Date: 2024-06-24
Hour: 6
Hour 6 footprint failed, band 1 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 7
Hour 7 footprint failed, band 2 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 8
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2025-05-07 13:35:08,669 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:08,673 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:08,674 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:08,677 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:08,678 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,681 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:08,683 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,683 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,691 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:08,693 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:08,694 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:08,695 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:08,698 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:08,699 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,726 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,727 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,728 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,729 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,730 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:08,732 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:08,733 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:08,734 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:08,739 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:08,741 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:08,744 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:08,745 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,749 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:08,749 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,750 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,759 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:08,760 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:08,761 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:08,761 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:08,764 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:08,765 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,790 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,790 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,792 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,792 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,793 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:08,795 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:08,797 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:08,798 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:08,803 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:08,805 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:08,809 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:08,810 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,812 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:08,813 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,813 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,820 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:08,822 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:08,823 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:08,823 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:08,825 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:08,826 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,849 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,851 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,852 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,852 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,853 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:08,855 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:08,856 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:08,857 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:08,862 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:08,863 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:08,867 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:08,868 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,872 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:08,873 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,873 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,880 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:08,881 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:08,882 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:08,883 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:08,886 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:08,886 - FFPModel - INFO - Domain setup completed successfully
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 8 footprint failed, band 3 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 9
Hour 9 footprint failed, band 4 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 10
Hour 10 footprint failed, band 5 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 11
Hour 11 footprint failed, band 6 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 12
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,926 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,927 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,928 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,930 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:08,931 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:08,936 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:08,939 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:08,942 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:08,951 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:08,955 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:08,961 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:08,963 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,965 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:08,966 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,967 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:08,975 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:08,977 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:08,977 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:08,978 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:08,980 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:08,981 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,013 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,014 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,016 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,017 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,019 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:09,023 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:09,025 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:09,027 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:09,032 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:09,034 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:09,038 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:09,039 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,043 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:09,043 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,044 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,055 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:09,057 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:09,062 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:09,064 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:09,072 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:09,074 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:09,079 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:09,081 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:09,088 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:09,090 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:09,097 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:09,099 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:09,099 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:09,100 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:09,103 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:09,104 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,128 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,129 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,130 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,130 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,131 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:09,134 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:09,135 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:09,136 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:09,142 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:09,144 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:09,148 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:09,150 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,154 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:09,155 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,156 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,165 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:09,168 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:09,169 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:09,170 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:09,173 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:09,174 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,202 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 12 footprint failed, band 7 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 13
Hour 13 footprint failed, band 8 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 14
Hour 14 footprint failed, band 9 not written.
all rs values must be between 0 and 1
Hour: 15
Hour 15 footprint failed, band 10 not written.
all rs values must be between 0 and 1
Hour: 16
Hour 16 footprint failed, band 11 not written.
all rs values must be between 0 and 1
Hour: 17
Hour 17 footprint failed, band 12 not written.
all rs values must be between 0 and 1
Hour: 18
Hour 18 footprint failed, band 13 not written.
all rs values must be between 0 and 1
Date: 2024-06-24
Hour: 6
Hour 6 footprint failed, band 1 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 7
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,204 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,205 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,206 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,207 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:09,209 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:09,210 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:09,212 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:09,217 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:09,219 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:09,223 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:09,224 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,230 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:09,231 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,231 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,242 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:09,244 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:09,245 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:09,246 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:09,250 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:09,250 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,282 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,283 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,283 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,287 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,289 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:09,293 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:09,295 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:09,296 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:09,303 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:09,304 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:09,308 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:09,309 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,313 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:09,313 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,314 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,321 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:09,324 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:09,324 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:09,325 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:09,328 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:09,328 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,357 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,358 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,359 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,360 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,361 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:09,363 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:09,364 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:09,365 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:09,369 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:09,371 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:09,374 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:09,375 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,378 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:09,379 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,379 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,386 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:09,388 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:09,389 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:09,389 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:09,392 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:09,392 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,418 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,419 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,420 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,421 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,422 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:09,424 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:09,425 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:09,426 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:09,430 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:09,432 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:09,436 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:09,437 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,440 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:09,440 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,441 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 7 footprint failed, band 2 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 8
Hour 8 footprint failed, band 3 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 9
Hour 9 footprint failed, band 4 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 10
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2025-05-07 13:35:09,448 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:09,450 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:09,451 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:09,451 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:09,454 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:09,455 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,478 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,479 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,479 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,480 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,481 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:09,484 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:09,491 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:09,493 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:09,498 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:09,501 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:09,505 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:09,506 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,509 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:09,510 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,511 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,520 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:09,522 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:09,523 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:09,523 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:09,526 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:09,527 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,557 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,557 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,558 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,559 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,560 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:09,562 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:09,563 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:09,564 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:09,568 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:09,570 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:09,574 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:09,574 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,578 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:09,578 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,579 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,586 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:09,587 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:09,588 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:09,589 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:09,591 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:09,592 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,620 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,621 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,621 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,622 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,623 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:09,626 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:09,627 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:09,628 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:09,633 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:09,634 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:09,638 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:09,639 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,642 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:09,643 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,643 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 10 footprint failed, band 5 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 11
Hour 11 footprint failed, band 6 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 12
Hour 12 footprint failed, band 7 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 13
Hour 13 footprint failed, band 8 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 14
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2025-05-07 13:35:09,651 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:09,653 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:09,658 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:09,660 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:09,666 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:09,669 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:09,676 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:09,679 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:09,687 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:09,690 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:09,697 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:09,700 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:09,701 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:09,702 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:09,705 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:09,705 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,733 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,735 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,736 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,738 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,739 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:09,742 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:09,743 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:09,744 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:09,750 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:09,752 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:09,758 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:09,759 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,763 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:09,764 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,764 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,773 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:09,775 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:09,776 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:09,777 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:09,780 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:09,780 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,808 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,808 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,809 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,810 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,811 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:09,813 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:09,815 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:09,816 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:09,822 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:09,824 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:09,828 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:09,829 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,833 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:09,834 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,835 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,844 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:09,846 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:09,847 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:09,848 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:09,852 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:09,852 - FFPModel - INFO - Domain setup completed successfully
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 14 footprint failed, band 9 not written.
all rs values must be between 0 and 1
Hour: 15
Hour 15 footprint failed, band 10 not written.
all rs values must be between 0 and 1
Hour: 16
Hour 16 footprint failed, band 11 not written.
all rs values must be between 0 and 1
Hour: 17
Hour 17 footprint failed, band 12 not written.
all rs values must be between 0 and 1
Hour: 18
Hour 18 footprint failed, band 13 not written.
all rs values must be between 0 and 1
Date: 2024-06-24
Hour: 6
Hour 6 footprint failed, band 1 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 7
Hour 7 footprint failed, band 2 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 8
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,878 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,878 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,880 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,881 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,882 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:09,884 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:09,885 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:09,887 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:09,891 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:09,893 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:09,897 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:09,898 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,902 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:09,903 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,903 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:09,912 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:09,913 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:09,914 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:09,918 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:09,924 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:09,926 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,975 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,976 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,979 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,980 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:09,984 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:09,989 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:09,993 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:09,995 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:10,001 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:10,002 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:10,006 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:10,007 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,010 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:10,010 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,011 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,025 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:10,028 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:10,029 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:10,029 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:10,033 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:10,033 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,059 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,059 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,060 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,061 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,061 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:10,064 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:10,065 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:10,066 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:10,070 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:10,072 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:10,076 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:10,076 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,081 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:10,081 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,082 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,090 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:10,092 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:10,092 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:10,093 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:10,096 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:10,096 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,121 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 8 footprint failed, band 3 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 9
Hour 9 footprint failed, band 4 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 10
Hour 10 footprint failed, band 5 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 11
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,122 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,123 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,124 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,124 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:10,127 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:10,127 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:10,128 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:10,133 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:10,135 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:10,139 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:10,139 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,143 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:10,144 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,144 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,153 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:10,155 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:10,155 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:10,156 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:10,159 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:10,159 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,185 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,186 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,187 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,188 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,191 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:10,195 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:10,197 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:10,198 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:10,204 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:10,206 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:10,210 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:10,210 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,213 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:10,214 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,214 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,222 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:10,224 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:10,225 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:10,225 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:10,228 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:10,229 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,251 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,252 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,253 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,254 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,254 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:10,257 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:10,258 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:10,259 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:10,263 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:10,264 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:10,269 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:10,269 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,273 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:10,274 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,274 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,281 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:10,283 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:10,288 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:10,290 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:10,295 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:10,296 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:10,302 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:10,304 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:10,309 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:10,311 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:10,318 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:10,320 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:10,320 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:10,321 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:10,323 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:10,324 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,349 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,350 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,351 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,352 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,353 - FFPModel - INFO - strongly_stable: 0 points (nan%)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 11 footprint failed, band 6 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 12
Hour 12 footprint failed, band 7 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 13
Hour 13 footprint failed, band 8 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 14
Hour 14 footprint failed, band 9 not written.
all rs values must be between 0 and 1
Hour: 15
Hour 15 footprint failed, band 10 not written.
all rs values must be between 0 and 1
Hour: 16
Hour 16 footprint failed, band 11 not written.
all rs values must be between 0 and 1
Hour: 17
Hour 17 footprint failed, band 12 not written.
all rs values must be between 0 and 1
Hour: 18
Hour 18 footprint failed, band 13 not written.
all rs values must be between 0 and 1
Date: 2024-06-24
Hour: 6
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2025-05-07 13:35:10,356 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:10,357 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:10,358 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:10,362 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:10,363 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:10,367 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:10,368 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,371 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:10,372 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,373 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,382 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:10,384 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:10,384 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:10,385 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:10,388 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:10,389 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,415 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,417 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,418 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,419 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,420 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:10,422 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:10,423 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:10,425 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:10,430 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:10,433 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:10,440 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:10,441 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,444 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:10,445 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,446 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,456 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:10,458 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:10,459 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:10,459 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:10,462 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:10,463 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,491 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,492 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,493 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,494 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,495 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:10,497 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:10,498 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:10,500 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:10,505 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:10,508 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:10,512 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:10,513 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,518 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:10,518 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,519 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,528 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:10,530 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:10,530 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:10,531 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:10,535 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:10,535 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,563 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,564 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,565 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,566 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,567 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:10,570 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:10,571 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:10,572 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:10,577 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:10,579 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 6 footprint failed, band 1 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 7
Hour 7 footprint failed, band 2 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 8
Hour 8 footprint failed, band 3 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 9
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2025-05-07 13:35:10,583 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:10,584 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,588 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:10,589 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,590 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,600 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:10,602 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:10,603 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:10,604 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:10,608 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:10,608 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,634 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,635 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,636 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,638 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,639 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:10,641 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:10,642 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:10,643 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:10,647 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:10,649 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:10,654 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:10,655 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,657 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:10,657 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,658 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,666 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:10,668 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:10,669 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:10,669 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:10,673 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:10,673 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,700 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,701 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,702 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,703 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,704 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:10,706 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:10,708 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:10,709 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:10,714 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:10,715 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:10,719 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:10,720 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,723 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:10,724 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,725 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,732 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:10,735 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:10,736 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:10,737 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:10,740 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:10,741 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,764 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,764 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,765 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,766 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,767 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:10,770 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:10,775 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:10,777 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:10,790 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:10,793 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 9 footprint failed, band 4 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 10
Hour 10 footprint failed, band 5 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 11
Hour 11 footprint failed, band 6 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 12
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2025-05-07 13:35:10,803 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:10,806 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,810 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:10,811 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,812 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,829 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:10,834 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:10,836 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:10,838 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:10,845 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:10,846 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,893 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,893 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,894 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,895 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:10,896 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:10,898 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:10,901 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:10,904 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:10,911 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:10,913 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:10,919 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:10,920 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,923 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:10,924 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,925 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:10,933 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:10,935 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:10,941 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:10,943 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:10,948 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:10,950 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:10,956 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:10,958 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:10,963 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:10,964 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:10,974 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:10,976 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:10,978 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:10,978 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:10,981 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:10,981 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,005 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,006 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,006 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,007 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,008 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:11,010 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:11,011 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:11,012 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:11,016 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:11,018 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 12 footprint failed, band 7 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 13
Hour 13 footprint failed, band 8 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 14
Hour 14 footprint failed, band 9 not written.
all rs values must be between 0 and 1
Hour: 15
Hour 15 footprint failed, band 10 not written.
all rs values must be between 0 and 1
Hour: 16
Hour 16 footprint failed, band 11 not written.
all rs values must be between 0 and 1
Hour: 17
Hour 17 footprint failed, band 12 not written.
all rs values must be between 0 and 1
Hour: 18
Hour 18 footprint failed, band 13 not written.
all rs values must be between 0 and 1
Date: 2024-06-24
Hour: 6
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2025-05-07 13:35:11,021 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:11,022 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,026 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:11,027 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,027 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,034 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:11,036 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:11,037 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:11,037 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:11,040 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:11,040 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,068 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,069 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,070 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,071 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,071 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:11,074 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:11,075 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:11,076 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:11,080 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:11,081 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:11,085 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:11,086 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,090 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:11,090 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,091 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,097 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:11,100 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:11,101 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:11,102 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:11,104 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:11,105 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,129 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,129 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,131 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,132 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,133 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:11,136 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:11,137 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:11,138 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:11,142 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:11,143 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:11,147 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:11,148 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,151 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:11,152 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,152 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,160 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:11,161 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:11,162 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:11,162 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:11,165 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:11,166 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,188 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,189 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,190 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,191 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,192 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:11,194 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:11,195 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:11,196 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:11,200 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:11,201 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:11,205 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:11,205 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,208 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:11,209 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,209 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,216 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:11,217 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:11,218 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:11,219 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:11,221 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:11,222 - FFPModel - INFO - Domain setup completed successfully
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 6 footprint failed, band 1 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 7
Hour 7 footprint failed, band 2 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 8
Hour 8 footprint failed, band 3 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 9
Hour 9 footprint failed, band 4 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 10
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,246 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,247 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,248 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,249 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,250 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:11,252 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:11,253 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:11,254 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:11,258 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:11,260 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:11,264 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:11,265 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,269 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:11,270 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,271 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,279 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:11,281 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:11,282 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:11,282 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:11,286 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:11,287 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,313 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,314 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,314 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,315 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,316 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:11,319 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:11,321 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:11,322 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:11,327 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:11,328 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:11,332 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:11,332 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,336 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:11,337 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,338 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,346 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:11,347 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:11,348 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:11,348 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:11,351 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:11,352 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,375 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,376 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,377 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,378 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,379 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:11,381 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:11,382 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:11,383 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:11,389 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:11,391 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:11,394 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:11,395 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,398 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:11,399 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,399 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,407 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:11,409 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:11,410 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:11,410 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:11,412 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:11,413 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,438 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,439 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,440 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,441 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,442 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:11,444 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:11,445 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:11,447 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:11,452 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:11,453 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:11,457 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:11,457 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,459 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:11,460 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,460 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,468 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:11,470 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:11,475 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:11,477 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 10 footprint failed, band 5 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 11
Hour 11 footprint failed, band 6 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 12
Hour 12 footprint failed, band 7 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 13
Hour 13 footprint failed, band 8 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 14
Hour 14 footprint failed, band 9 not written.
all rs values must be between 0 and 1
Hour: 15
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2025-05-07 13:35:11,481 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:11,484 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:11,490 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:11,492 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:11,498 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:11,501 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:11,508 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:11,510 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:11,511 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:11,512 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:11,515 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:11,515 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,542 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,543 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,543 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,544 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,545 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:11,547 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:11,548 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:11,551 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:11,556 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:11,557 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:11,561 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:11,562 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,565 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:11,566 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,566 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,574 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:11,576 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:11,577 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:11,578 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:11,580 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:11,581 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,613 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,614 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,615 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,616 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,617 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:11,620 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:11,621 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:11,622 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:11,626 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:11,627 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:11,631 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:11,631 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,634 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:11,635 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,635 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,642 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:11,645 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:11,646 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:11,646 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:11,649 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:11,650 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,672 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,672 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,673 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,674 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,675 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:11,677 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:11,677 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:11,678 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 15 footprint failed, band 10 not written.
all rs values must be between 0 and 1
Hour: 16
Hour 16 footprint failed, band 11 not written.
all rs values must be between 0 and 1
Hour: 17
Hour 17 footprint failed, band 12 not written.
all rs values must be between 0 and 1
Hour: 18
Hour 18 footprint failed, band 13 not written.
all rs values must be between 0 and 1
Date: 2024-06-24
Hour: 6
Hour 6 footprint failed, band 1 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 7
Hour 7 footprint failed, band 2 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 8
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2025-05-07 13:35:11,682 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:11,684 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:11,687 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:11,688 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,694 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:11,695 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,696 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,710 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:11,713 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:11,714 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:11,718 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:11,724 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:11,725 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,780 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,781 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,781 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,782 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,783 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:11,785 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:11,787 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:11,788 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:11,794 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:11,797 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:11,806 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:11,807 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,809 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:11,810 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,810 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,818 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:11,820 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:11,821 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:11,822 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:11,824 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:11,825 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,847 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,847 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,848 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,849 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,850 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:11,852 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:11,853 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:11,854 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:11,858 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:11,859 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:11,862 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:11,863 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,867 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:11,867 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,868 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,875 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:11,876 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:11,877 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:11,878 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:11,880 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:11,881 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,903 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,904 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,905 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,906 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,907 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:11,909 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:11,910 - FFPModel - INFO - Starting footprint calculation...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 8 footprint failed, band 3 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 9
Hour 9 footprint failed, band 4 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 10
Hour 10 footprint failed, band 5 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 11
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2025-05-07 13:35:11,911 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:11,916 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:11,918 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:11,922 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:11,923 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,927 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:11,927 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,928 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,936 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:11,938 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:11,939 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:11,940 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:11,942 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:11,943 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,971 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,972 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,973 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,974 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:11,975 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:11,977 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:11,978 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:11,980 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:11,985 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:11,986 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:11,990 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:11,991 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,993 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:11,994 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:11,994 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,002 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:12,004 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:12,004 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:12,005 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:12,008 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:12,009 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,036 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,036 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,037 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,038 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,038 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:12,040 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:12,041 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:12,042 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:12,046 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:12,048 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:12,052 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:12,053 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,056 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:12,057 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,057 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,065 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:12,067 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:12,073 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:12,075 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:12,080 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:12,082 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:12,088 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:12,090 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:12,095 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:12,097 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:12,102 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:12,105 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:12,106 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:12,106 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:12,108 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:12,109 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,133 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,134 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,135 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,136 - FFPModel - INFO - stable: 0 points (nan%)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 11 footprint failed, band 6 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 12
Hour 12 footprint failed, band 7 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 13
Hour 13 footprint failed, band 8 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 14
Hour 14 footprint failed, band 9 not written.
all rs values must be between 0 and 1
Hour: 15
Hour 15 footprint failed, band 10 not written.
all rs values must be between 0 and 1
Hour: 16
Hour 16 footprint failed, band 11 not written.
all rs values must be between 0 and 1
Hour: 17
Hour 17 footprint failed, band 12 not written.
all rs values must be between 0 and 1
Hour: 18
Hour 18 footprint failed, band 13 not written.
all rs values must be between 0 and 1
Date: 2024-06-24
Hour: 6
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,138 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:12,140 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:12,141 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:12,143 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:12,147 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:12,148 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:12,153 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:12,154 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,158 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:12,158 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,159 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,167 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:12,169 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:12,170 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:12,171 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:12,174 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:12,175 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,204 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,205 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,206 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,206 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,207 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:12,209 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:12,210 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:12,211 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:12,215 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:12,217 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:12,222 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:12,223 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,226 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:12,227 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,227 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,235 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:12,237 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:12,237 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:12,238 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:12,241 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:12,241 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,269 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,269 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,270 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,271 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,272 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:12,274 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:12,275 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:12,277 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:12,280 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:12,282 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:12,286 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:12,287 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,289 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:12,290 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,290 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,297 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:12,298 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:12,299 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:12,300 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:12,302 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:12,303 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,328 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,329 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,330 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,331 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,332 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:12,335 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:12,336 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:12,338 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:12,343 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:12,345 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:12,349 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:12,349 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,352 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:12,352 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,353 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,360 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:12,361 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:12,362 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:12,363 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:12,365 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:12,366 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,391 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 6 footprint failed, band 1 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 7
Hour 7 footprint failed, band 2 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 8
Hour 8 footprint failed, band 3 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 9
Hour 9 footprint failed, band 4 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 10
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,392 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,393 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,394 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,395 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:12,397 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:12,398 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:12,400 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:12,404 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:12,405 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:12,408 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:12,409 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,413 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:12,414 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,414 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,423 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:12,425 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:12,425 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:12,426 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:12,428 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:12,429 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,455 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,456 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,457 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,457 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,458 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:12,460 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:12,461 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:12,462 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:12,467 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:12,468 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:12,472 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:12,473 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,476 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:12,477 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,477 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,485 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:12,487 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:12,487 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:12,488 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:12,490 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:12,491 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,514 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,515 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,515 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,517 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,518 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:12,520 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:12,521 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:12,523 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:12,530 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:12,531 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:12,536 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:12,537 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,540 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:12,540 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,541 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,548 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:12,550 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:12,551 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:12,551 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:12,554 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:12,555 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,580 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,581 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,582 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,583 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,584 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:12,586 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:12,587 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:12,588 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:12,591 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:12,593 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:12,596 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:12,597 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,601 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:12,601 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,602 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,609 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:12,611 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:12,617 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:12,619 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:12,624 - FFPModel - DEBUG - Valid input length: 1
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 10 footprint failed, band 5 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 11
Hour 11 footprint failed, band 6 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 12
Hour 12 footprint failed, band 7 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 13
Hour 13 footprint failed, band 8 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 14
Hour 14 footprint failed, band 9 not written.
all rs values must be between 0 and 1
Hour: 15
Hour 15 footprint failed, band 10 not written.
all rs values must be between 0 and 1
Hour: 16
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2025-05-07 13:35:12,626 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:12,631 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:12,633 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:12,639 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:12,641 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:12,650 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:12,654 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:12,660 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:12,662 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:12,668 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:12,669 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,722 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,723 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,726 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,727 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,728 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:12,733 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:12,735 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:12,737 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:12,745 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:12,747 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:12,755 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:12,758 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,762 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:12,764 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,765 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,776 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:12,778 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:12,779 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:12,779 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:12,782 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:12,783 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,812 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,813 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,813 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,814 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,815 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:12,817 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:12,818 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:12,819 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:12,823 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:12,825 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:12,828 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:12,828 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,832 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 16 footprint failed, band 11 not written.
all rs values must be between 0 and 1
Hour: 17
Hour 17 footprint failed, band 12 not written.
all rs values must be between 0 and 1
Hour: 18
Hour 18 footprint failed, band 13 not written.
all rs values must be between 0 and 1
Date: 2024-06-24
Hour: 6
Hour 6 footprint failed, band 1 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 7
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2025-05-07 13:35:12,833 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,833 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,841 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:12,843 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:12,843 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:12,844 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:12,847 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:12,847 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,876 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,877 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,878 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,879 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,880 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:12,883 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:12,884 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:12,885 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:12,891 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:12,892 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:12,897 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:12,898 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,902 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:12,903 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,903 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,911 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:12,913 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:12,913 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:12,914 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:12,918 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:12,919 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,952 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,953 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,954 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,955 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:12,956 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:12,960 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:12,962 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:12,963 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:12,968 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:12,970 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:12,975 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:12,976 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,979 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:12,979 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,980 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:12,988 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:12,990 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:12,991 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:12,992 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:12,994 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:12,995 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:13,020 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:13,021 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:13,022 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:13,023 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:13,024 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:13,027 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:13,028 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:13,029 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:13,033 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:13,034 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:13,038 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:13,039 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 7 footprint failed, band 2 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 8
Hour 8 footprint failed, band 3 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 9
Hour 9 footprint failed, band 4 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 10
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2025-05-07 13:35:13,043 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:13,044 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:13,044 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:13,053 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:13,055 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:13,056 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:13,057 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:13,060 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:13,061 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:13,088 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:13,089 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:13,090 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:13,091 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:13,092 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:13,094 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:13,095 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:13,096 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:13,102 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:13,103 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:13,108 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:13,108 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:13,111 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:13,112 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:13,112 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:13,120 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:13,122 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:13,123 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:13,123 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:13,126 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:13,127 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:13,149 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:13,150 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:13,150 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:13,151 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:13,152 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:13,155 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:13,156 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:13,157 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:13,161 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:13,162 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:13,166 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:13,167 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:13,170 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:13,171 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:13,172 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:13,179 - FFPModel - DEBUG - Valid input length: 0
2025-05-07 13:35:13,180 - FFPModel - INFO - Mean RSL height (z*): nanm, Measurement height: 2.0m
2025-05-07 13:35:13,181 - FFPModel - INFO - Setting up computational domain...
2025-05-07 13:35:13,182 - FFPModel - DEBUG - Domain dimensions - x: 135, y: 135
2025-05-07 13:35:13,185 - FFPModel - DEBUG - Grid shapes - xv: (135, 135), rho: (135, 135)
2025-05-07 13:35:13,185 - FFPModel - INFO - Domain setup completed successfully
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:13,215 - FFPModel - INFO - strongly_unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:13,217 - FFPModel - INFO - unstable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:13,218 - FFPModel - INFO - neutral: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:13,220 - FFPModel - INFO - stable: 0 points (nan%)
c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py:762: RuntimeWarning: invalid value encountered in divide
  percentage = (count / self.ts_len) * 100
2025-05-07 13:35:13,221 - FFPModel - INFO - strongly_stable: 0 points (nan%)
2025-05-07 13:35:13,224 - FFPModel - INFO - Starting FFP model calculations...
2025-05-07 13:35:13,225 - FFPModel - INFO - Starting footprint calculation...
2025-05-07 13:35:13,227 - FFPModel - DEBUG - Rotated theta shape: (135, 135, 0)
2025-05-07 13:35:13,232 - FFPModel - DEBUG - Stability regime counts - Stable: 0, Unstable: 0, Neutral: 0
2025-05-07 13:35:13,235 - FFPModel - DEBUG - Initializing arrays with shape: x=135, y=135
2025-05-07 13:35:13,240 - FFPModel - DEBUG - xstar_ci_dummy shape: (135, 135, 0)
2025-05-07 13:35:13,241 - FFPModel - ERROR - Error in footprint calculation: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:13,244 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity

2025-05-07 13:35:13,244 - FFPModel - ERROR - Error in FFP calculations: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:13,245 - FFPModel - DEBUG - Traceback:
Traceback (most recent call last):
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1773, in run
    self.fclim_2d = self.calc_xr_footprint()  # Now returns fclim_2d directly
                    ~~~~~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\Documents\GitHub\footprints\docs\notebooks\../../src\fluxfootprints\improved_ffp.py&#34;, line 1058, in calc_xr_footprint
    f&#34;xstar_ci_dummy range: {float(xstar_ci_dummy.min())} to {float(xstar_ci_dummy.max())}&#34;
                                   ~~~~~~~~~~~~~~~~~~^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\_aggregations.py&#34;, line 2899, in min
    return self.reduce(
           ~~~~~~~~~~~^
        duck_array_ops.min,
        ^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\dataarray.py&#34;, line 3875, in reduce
    var = self.variable.reduce(func, dim, axis, keep_attrs, keepdims, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\variable.py&#34;, line 1654, in reduce
    result = super().reduce(
        func=func, dim=dim, axis=axis, keepdims=keepdims, **kwargs
    )
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\namedarray\core.py&#34;, line 921, in reduce
    data = func(self.data, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\duck_array_ops.py&#34;, line 499, in f
    return func(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nanops.py&#34;, line 71, in nanmin
    return nputils.nanmin(a, axis=axis)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\xarray\core\nputils.py&#34;, line 242, in f
    result = getattr(npmodule, name)(values, axis=axis, **kwargs)
  File &#34;c:\Users\paulinkenbrandt\.conda\envs\py313\Lib\site-packages\numpy\lib\_nanfunctions_impl.py&#34;, line 357, in nanmin
    res = np.fmin.reduce(a, axis=axis, out=out, **kwargs)
ValueError: zero-size array to reduction operation fmin which has no identity
2025-05-07 13:35:13,253 - FFPModel - DEBUG - Valid input length: 1
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 10 footprint failed, band 5 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 11
Hour 11 footprint failed, band 6 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 12
Hour 12 footprint failed, band 7 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 13
Hour 13 footprint failed, band 8 not written.
zero-size array to reduction operation fmin which has no identity
Hour: 14
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2025-05-07 13:35:13,255 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:13,261 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:13,263 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:13,269 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:13,271 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:13,277 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:13,279 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
2025-05-07 13:35:13,285 - FFPModel - DEBUG - Valid input length: 1
2025-05-07 13:35:13,289 - FFPModel - INFO - Mean RSL height (z*): 0.7m, Measurement height: 2.0m
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hour 14 footprint failed, band 9 not written.
all rs values must be between 0 and 1
Hour: 15
Hour 15 footprint failed, band 10 not written.
all rs values must be between 0 and 1
Hour: 16
Hour 16 footprint failed, band 11 not written.
all rs values must be between 0 and 1
Hour: 17
Hour 17 footprint failed, band 12 not written.
all rs values must be between 0 and 1
Hour: 18
Hour 18 footprint failed, band 13 not written.
all rs values must be between 0 and 1
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span><span class="n">temp_line</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">14</span><span class="p">))</span>
<span class="n">src</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;../../station_config/output/a2021-05-20_US-UTE.tif&quot;</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-intense-fg ansi-bold">In[1], line 1</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 1</span> <span class="ansi-yellow-bg">plt</span><span style="color: rgb(98,98,98)">.</span>figure(figsize<span style="color: rgb(98,98,98)">=</span>(<span style="color: rgb(98,98,98)">14</span>,<span style="color: rgb(98,98,98)">14</span>))
<span class="ansi-green-fg">      2</span> src <span style="color: rgb(98,98,98)">=</span> rasterio<span style="color: rgb(98,98,98)">.</span>open(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">../../station_config/output/a2021-05-20_US-UTE.tif</span><span style="color: rgb(175,0,0)">&#34;</span>)
<span class="ansi-green-fg">      3</span> show(src)

<span class="ansi-red-intense-fg ansi-bold">NameError</span>: name &#39;plt&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="c1"># Daily average</span>
<span class="n">arrs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">):</span>
    <span class="n">arr</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">arr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="k">continue</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">arrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="n">avg_for_day</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">arrs</span><span class="p">)</span> <span class="o">/</span> <span class="n">cnt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">avg_for_day</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../modeltypes.html" class="btn btn-neutral float-left" title="Outline of Flux Measurement Footprint Estimation Approaches" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="row_footprint.html" class="btn btn-neutral float-right" title="&lt;no title&gt;" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Paul Inkenbrandt, Natascha Kljun, John Volk.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>